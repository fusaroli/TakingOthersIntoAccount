---
title: "Analysis code for Simonsen et al, Taking Others into Account"
author: "Riccardo Fusaroli, Malte Lau Petersen & Arndis Simonsen"
output: html_document
---

```{r options, include=FALSE, message=F, warning=F}
library(knitr)
opts_chunk$set(eval = FALSE, include= TRUE)
```


```{r setup, eval = TRUE, message=F, warning=F}
pacman::p_load(brms,tidyverse,tidybayes,bayesplot,boot,loo,rstan,glue,ggpubr)
```


# Experimental context

## Sensory information

k of 8 balls in the bag are red -> coded as logit(k/8)

## Others information
The participants had two pieces of information about the others: how many (out of 4) guessed red, and how confident were those that guessed red and those that guessed green (low vs high confidence).

In order for parameters in the full(er) model(s) to be interpretable as "weight put on evidence from the outside", we split this information to create eight variables, four expressing the choice of one "Other" each, four the confidence of one "Other" each. Since, in the experiment, the face of the Others changed every trial, and no feedback was given, there was no chance for a participant to learn to assign specific weight to a specific other. Accordingly we model all Others with the same coefficients. In each trial, the participant is assumed to combine information from five sources: One from their own perception (12.5% to 87.5%), which is weighted by its own "self" parameter, and four from social sources, which is weighted by a shared "others" parameter.

# Load & pre-process data

```{r load data, eval = TRUE}
# which bounds to truncate "evidence" at 
lower_bound = .1
upper_bound = .9


transform_logit <- function(x, lower = 0.1, upper = 0.9) {
    # "evidence" at more than 90% probability is truncated to 90%
    x[x > upper] = upper
    x[x < lower] = lower
    # .. then transformed to log odds
    return(logit(x))
}

full_data = read_csv("data/data.csv") %>%
    # for efficiency while testing
    # sample_n(100) %>%
    # Rename a few things for consistency to earlier versions of the data
    mutate(Participant = Subject,
           Diagnosis = Group,
           ChoiceRed = RedChoice,
           row = 1:n())

for (col in c("SANS","SANS_noAttention", "SAPS", "PSP","SAPSalt", "SANSalt")) {
    # impute all NA's (participants in control group) at 0
    # .. with the suffix _i0 (imputed to 0)
    full_data[str_c(col, "_i0")] = ifelse(is.na(full_data[col]), 0, full_data[[col]])
}

for (col in c("Self", "Others1", "Others2", "Others3", "Others4", 
              "Others1NoC", "Others2NoC", "Others3NoC", "Others4NoC")) {
    # truncate "evidence" at the extremes to avoid logit(evidence) = Inf
    full_data[str_c("l", col)] = transform_logit(full_data[[col]], lower_bound, upper_bound)
}

## Scale symptoms and cognitive features on a 0-1 scale
full_data <- full_data %>% 
  mutate(
    SANSs = SANS/max(SANS,na.rm=T),
    SAPSs = SAPS/max(SAPS,na.rm=T),
    PSPs = PSP/max(PSP,na.rm=T),
    IQs = IQ/max(IQ,na.rm=T),
    CPZ = CPZ_GB/max(CPZ_GB,na.rm=T),
    WM_Errors = SWM_Total_errors / max(SWM_Total_errors,na.rm=T),
    IED_Errors = IED_Total_errors_adj / max(IED_Total_errors_adj,na.rm=T)
  )
full_data$PSPs_schizo[full_data$Diagnosis==1] <-full_data$PSP[full_data$Diagnosis==1]/max(full_data$PSP[full_data$Diagnosis==1],na.rm=T) # If full model
full_data$IQs_schizo[full_data$Diagnosis==1] <-full_data$IQ[full_data$Diagnosis==1]/max(full_data$IQ[full_data$Diagnosis==1],na.rm=T) # If full model
full_data$CPZs_schizo[full_data$Diagnosis==1] <-full_data$CPZ_GB[full_data$Diagnosis==1]/max(full_data$CPZ_GB[full_data$Diagnosis==1],na.rm=T) # If full model

```

# Stan settings
```{r stan settings, eval = TRUE}
source("scripts/ppc_functions.R")
source("scripts/fit_simplex_priors.R")

N_CORES = 2
ITER = 8e3
STAN_CONTROL = list(
    adapt_delta = .999,
    max_treedepth = 20)

```


## Naive Bayes
Two pieces of evidence (a, b) can be combined with bayes rule

`P(x | a,b) = P(x|a) * P(x|b) / (P(x|a) * P(x|b) + (1-P(x|a)) * (1-P(x|b)))`

Or, equivalently, this can be done by adding them on the logit scale

`P(x | a,b) = inv.logit(logit(P(x|a)) + logit(P(x|b)))`

This is the simplest model (Naive Bayes) for what happens when participants combine sensory information (6 out of 8 balls in the bag are red) with social information (1 out of 4 others guessed red).

In this model, there is only one main effect to be estimated, the bias (towards red or green).

There are two versions of the model: one modeling participants as independent from each others and one including potential effects of diagnosis. In this latter model we include the matching of participants (in terms of gender, age, parental education and geographical provenance), replacing the random effect by participant with a random effect of intercent and random slope of diagnosis by subject pair (matched control and participant).


```{r naivebayes, eval = F}

naive_diagnosis_f = bf(ChoiceRed ~ bias + lSelf + lOthers1 + lOthers2 + lOthers3 + lOthers4,
             bias ~ 1 + Diagnosis + (1 +  Diagnosis |p| SubjectPair),
             nl = TRUE)

naive_prior = c(
  prior(normal(0,1), nlpar = "bias"),
  prior(normal(0,1), nlpar = "bias", class="sd")
  )

naive_diagnosis_m = brm(naive_diagnosis_f,
              full_data,
              prior = naive_prior,
              sample_prior = TRUE,
              family = "bernoulli",
              file = "models/naive_diagnosis_m",
              chains = N_CORES, cores = N_CORES, iter = ITER,
              control = STAN_CONTROL)

naive_diagnosis_m <- add_criterion(naive_diagnosis_m, criterion=c("waic","loo","R2"), file = "models/naive_diagnosis_m")

```


## Weighted Bayes

The next step up is to allow for participants to put a different weight on to different sources of information. Now there are three main parameters: The weight put on evidence coming from one's self (the sensory information, k of 8 balls in the bag are red), and the weight put on evidence from others. This is done with the function defined below: The evidence L (in log odds) is multiplied by the loop strength a and then weighted by the weight w. Here we transform a and w before using them in order to be able to parametrize them in later models.

- Loop strength (used later in the circular inference model) a uses `exp` as its link function to costrain it to be positive. An input of 0 then corresponds to multiplying the evidence by `exp(0) = 1`.
- The weight w need to be on a scale of .5 to 1, so we use a scaled inverted logit transform. Values below 0 or 1 are non-sensical, while values between 0 and .5 implies that evidence counts in the opposite direction. Weight at exactly .5 means that the evidence is not being counted at all. 

```{r F function, eval = TRUE}

F <- function(a_raw, L_raw, w_raw) {
    # weighting function in R
    a = exp(a_raw)
    L = exp(L_raw * a)
    w = inv_logit_scaled(w_raw, 0.5, 1)
    log((w * L + 1 - w)/((1 - w) * L + w))
}

# weighting function in stan
F_stancode = "
real F(real a_raw, real L_raw, real w_raw) {
    real a;
    real L;
    real w;
    a = exp(a_raw);
    L = exp(L_raw * a);
    w = 0.5 + inv_logit(w_raw)/2;
    return log((w * L + 1 - w)./((1 - w) * L + w));
}
"
```


```{r weighted}

weighted_diagnosis_f = bf(ChoiceRed ~ bias + 
                    F(0, lSelf, wSelf) + 
                    F(0, lOthers1noC, wOthers + bConfidence * Confidence1) + 
                    F(0, lOthers2noC, wOthers + bConfidence * Confidence2) + 
                    F(0, lOthers3noC, wOthers + bConfidence * Confidence3) + 
                    F(0, lOthers4noC, wOthers + bConfidence * Confidence4),
                wSelf + wOthers + bConfidence + bias ~ 1 + Diagnosis + (1 +  Diagnosis |p| SubjectPair),
                nl = TRUE)

weighted_prior = c(prior(normal(0,1), nlpar = "wSelf"),
                   prior(normal(0,1), nlpar = "wOthers"),
                   prior(normal(0,1), nlpar = "bConfidence"),
                   prior(normal(1,1), nlpar = "wSelf", coef = "Intercept"),
                   prior(normal(1,1), nlpar = "wOthers", coef = "Intercept"),
                   prior(normal(0,.1), nlpar = "bias"),
                   prior(normal(0,.4), nlpar = "wSelf", class="sd"),
                   prior(normal(0,.4), nlpar = "wOthers", class="sd"),
                   prior(normal(0,.4), nlpar = "bConfidence", class="sd"),
                   prior(normal(0,.1), nlpar = "bias", class="sd"))


weighted_diagnosis_m = fit_brm(weighted_diagnosis_f,
                 full_data,
                 stan_funs = F_stancode,
                 prior = weighted_prior,
                 sample_prior = TRUE,
                 family = "bernoulli",
                 file = "models/weighted_diagnosis_m",
                 chains = N_CORES, cores = N_CORES, iter = ITER,
                 control = STAN_CONTROL)

weighted_diagnosis_m <- add_criterion(weighted_diagnosis_m, criterion=c("waic","loo","R2"), file = "models/weighted_diagnosis_m")

### ADD Prior and posterior predictive check
plot_ppc(weighted_diagnosis_m, "prior", diagnosis = TRUE)
# ggsave("pc_prior.png")
plot_ppc(weighted_diagnosis_m, "posterior", diagnosis = TRUE)
# ggsave("pc_posterior.png")

# Adding model by group for control analysis
weighted_f = bf(ChoiceRed ~ bias + 
                    F(0, lSelf, wSelf) + 
                    F(0, lOthers1noC, wOthers + bConfidence * Confidence1) + 
                    F(0, lOthers2noC, wOthers + bConfidence * Confidence2) + 
                    F(0, lOthers3noC, wOthers + bConfidence * Confidence3) + 
                    F(0, lOthers4noC, wOthers + bConfidence * Confidence4),
                wSelf + wOthers + bConfidence + bias ~ 1 + (1|p|Participant),
                nl = TRUE)

weighted_prior = c(prior(normal(0,1), nlpar = "wSelf"),
                   prior(normal(0,1), nlpar = "wOthers"),
                   prior(normal(1,1), nlpar = "bConfidence"),
                   prior(normal(1,1), nlpar = "wSelf", coef = "Intercept"),
                   prior(normal(1,1), nlpar = "wOthers", coef = "Intercept"),
                   prior(normal(0,.1), nlpar = "bias"),
                   prior(normal(0,.4), nlpar = "wSelf", class="sd"),
                   prior(normal(0,.4), nlpar = "wOthers", class="sd"),
                   prior(normal(0,.4), nlpar = "bConfidence", class="sd"),
                   prior(normal(0,.1), nlpar = "bias", class="sd"),
                   prior_("lkj(8)", class = "cor"))

weighted_schizophrenia_m = brm(weighted_f,
                 subset(full_data,Diagnosis==1),
                 stan_funs = F_stancode,
                 prior = weighted_prior,
                 sample_prior = TRUE,
                 family = "bernoulli",
                 file = "models/weighted_schizophrenia_m",
                 chains = N_CORES, cores = N_CORES, iter = ITER,
                 control = STAN_CONTROL)

weighted_schizophrenia_m <- add_criterion(weighted_schizophrenia_m, criterion=c("waic","loo","R2"),
                 file = "models/weighted_schizophrenia_m")

weighted_controls_m = brm(weighted_f,
                 subset(full_data,Diagnosis==0),
                 stan_funs = F_stancode,
                 prior = weighted_prior,
                 sample_prior = TRUE,
                 family = "bernoulli",
                 file = "models/weighted_controls_m",
                 chains = N_CORES, cores = N_CORES, iter = ITER,
                 control = STAN_CONTROL)

weighted_controls_m <- add_criterion(weighted_controls_m, criterion=c("waic","loo","R2"),file = "models/weighted_controls_m")


```



## Circular Inference

Now we're getting to the circular inference model. The Loop strength parameter, `a`, mentioned above is now a parameter that controls how much incoming information from one source or another reverberates to make what is effectively noise in the system. The base model is still the same: `ChoiceRed ~ bias + F(0, lSelf + I, wSelf) + F(0, lOthers1 + I, wOthers) + [...]`, but now the noise I is included as evidence from all sources `I = F(aSelf, lSelf, wSelf) + F(aOthers, lOthers1, wOthers) + F(aOthers, lOthers2, wOthers) + F(aOthers, lOthers3, wOthers) + F(aOthers, lOthers4, wOthers)`

```{r Circular Inference}

circular_diagnosis_f = bf(ChoiceRed ~ bias + 
                   F(0, lSelf + I, wSelf) +
                   F(0, lOthers1noC + I, wOthers + bConfidence * Confidence1) +
                   F(0, lOthers2noC + I, wOthers + bConfidence * Confidence2) +
                   F(0, lOthers3noC + I, wOthers + bConfidence * Confidence3) +
                   F(0, lOthers4noC + I, wOthers + bConfidence * Confidence4),
               wSelf + aSelf + wOthers + aOthers + bConfidence + bias ~ 1 + Diagnosis + (1 + Diagnosis|p|SubjectPair) ,
               nlf(I ~ F(aSelf, lSelf, wSelf) +
                          F(aOthers, lOthers1noC, wOthers + bConfidence * Confidence1) +
                          F(aOthers, lOthers2noC, wOthers + bConfidence * Confidence2) +
                          F(aOthers, lOthers3noC, wOthers + bConfidence * Confidence3) +
                          F(aOthers, lOthers4noC, wOthers + bConfidence * Confidence4)),
               nl = TRUE)

circular_prior = c(prior(normal(0,.3), nlpar = "wSelf"),
                   prior(normal(0,.3), nlpar = "wOthers"),
                   prior(normal(0,.3), nlpar = "aSelf"),
                   prior(normal(0,.3), nlpar = "aOthers"),
                   prior(normal(1,.5), nlpar = "bConfidence"),
                   prior(normal(0,.1), nlpar = "bias"),
                   prior(normal(1,1), nlpar = "wSelf", coef = "Intercept"),
                   prior(normal(1,1), nlpar = "wOthers", coef = "Intercept"),
                   prior(normal(0,1), nlpar = "aSelf", coef = "Intercept"),
                   prior(normal(0,1), nlpar = "aOthers", coef = "Intercept"),
                   prior(normal(0, .2), nlpar = "wSelf",class="sd"),
                   prior(normal(0, .2), nlpar = "wOthers",class="sd"),
                   prior(normal(0, .2), nlpar = "aSelf",class="sd"),
                   prior(normal(0, .2), nlpar = "aOthers",class="sd"),
                   prior(normal(0, .2), nlpar = "bConfidence",class="sd"),
                   prior(normal(0, .2), nlpar = "bias",class="sd"),
                   prior_("lkj(8)", class = "cor"))

circular_diagnosis_m = fit_brm(circular_diagnosis_f,
               full_data,
               stan_funs = F_stancode,
               prior = circular_prior,
               sample_prior = TRUE,
               family = "bernoulli",
               file = "models/circular_diagnosis_m",
               chains = N_CORES, cores = N_CORES, iter = ITER, refresh = 20,
               control = STAN_CONTROL)

circular_diagnosis_m <- add_criterion(circular_diagnosis_m, criterion=c("waic","loo","R2"), file = "models/circular_diagnosis_m")

### Now by group for control analysis

circular_f = bf(ChoiceRed ~ bias + 
                   F(0, lSelf + I, wSelf) +
                   F(0, lOthers1noC + I, wOthers + bConfidence * Confidence1) +
                   F(0, lOthers2noC + I, wOthers + bConfidence * Confidence2) +
                   F(0, lOthers3noC + I, wOthers + bConfidence * Confidence3) +
                   F(0, lOthers4noC + I, wOthers + bConfidence * Confidence4),
               wSelf + wOthers + aSelf + aOthers + bias + bConfidence ~ 1 + (1|p|Participant) ,
               nlf(I ~ F(aSelf, lSelf, wSelf) +
                          F(aOthers, lOthers1noC, wOthers + bConfidence * Confidence1) +
                          F(aOthers, lOthers2noC, wOthers + bConfidence * Confidence2) +
                          F(aOthers, lOthers3noC, wOthers + bConfidence * Confidence3) +
                          F(aOthers, lOthers4noC, wOthers + bConfidence * Confidence4)),
               nl = TRUE)

circular_prior = c(
  prior(normal(0,.3), nlpar = "wSelf"),
  prior(normal(0,.3), nlpar = "wOthers"),
  prior(normal(0,.3), nlpar = "aSelf"),
  prior(normal(0,.3), nlpar = "aOthers"),
  prior(normal(0,.1), nlpar = "bias"),
  prior(normal(1,.2), nlpar = "bConfidence"),
  prior(normal(1,1.5), nlpar = "wSelf", coef = "Intercept"),
  prior(normal(1,1.5), nlpar = "wOthers", coef = "Intercept"),
  prior(normal(0,1.5), nlpar = "aSelf", coef = "Intercept"),
  prior(normal(0,1.5), nlpar = "aOthers", coef = "Intercept"),
  prior(normal(0, .2), nlpar = "wSelf",class="sd"),
  prior(normal(0, .2), nlpar = "wOthers",class="sd"),
  prior(normal(0, .2), nlpar = "aSelf",class="sd"),
  prior(normal(0, .2), nlpar = "aOthers",class="sd"),
  prior(normal(0, .2), nlpar = "bConfidence",class="sd"),
  prior(normal(0, .2), nlpar = "bias",class="sd"),
  prior_("lkj(8)", class = "cor"))

circular_schizophrenia_m = fit_brm(circular_f,
               subset(full_data, Diagnosis==1),
               stan_funs = F_stancode,
               prior = circular_prior,
               sample_prior = TRUE,
               family = "bernoulli",
               file = "models/circular_schizophrenia_m",
               chains = N_CORES, cores = N_CORES, iter = ITER, refresh = 20,
               control = STAN_CONTROL)

circular_schizophrenia_m <- add_criterion(circular_schizophrenia_m,criterion=c("waic","loo","R2"),file = "models/circular_schizophrenia_m")

circular_controls_m = fit_brm(circular_f,
               subset(full_data, Diagnosis==0),
               stan_funs = F_stancode,
               prior = circular_prior,
               sample_prior = TRUE,
               family = "bernoulli",
               file = "models/circular_controls_m",
               chains = N_CORES, cores = N_CORES, iter = ITER,
               control = STAN_CONTROL)

circular_controls_m <- add_criterion(circular_controls_m,criterion=c("waic","loo","R2"),file = "models/circular_controls_m")

```

## Now a more traditional GLM analysis

```{r GLM, eval = TRUE}

glm_diagnosis_f = bf(ChoiceRed ~ bias +
                                  bSelf * Self + 
                                  bOthers * (lOthers1noC + lOthers2noC + lOthers3noC + lOthers4noC) +
                                  bConfidence * (Confidence1 * lOthers1noC + Confidence2 * lOthers2noC + Confidence3 * lOthers3noC + Confidence4 * lOthers4noC),
                                  bSelf + bOthers + bConfidence + bias ~ 1 + Diagnosis + (1 + Diagnosis | p | SubjectPair) ,
             nl = TRUE)

glm_prior = c(
  prior(normal(0, .1), nlpar = "bias"),
  prior(normal(0, 1), nlpar = "bSelf"),
  prior(normal(0, 1), nlpar = "bOthers"),
  prior(normal(0, 1), nlpar = "bConfidence"),
  prior(normal(0, .1), nlpar = "bias", class="sd"),
  prior(normal(0, .5), nlpar = "bSelf", class="sd"),
  prior(normal(0, .5), nlpar = "bOthers", class="sd"),
  prior(normal(0, .5), nlpar = "bConfidence", class="sd"))

glm_diagnosis_m = brm(glm_diagnosis_f,
             family="bernoulli",
             data = full_data,
             prior = glm_prior,
             sample_prior = TRUE,
             file = "models/glm_diagnosis_m",
             chains = N_CORES, cores = N_CORES, iter = ITER,
             control = STAN_CONTROL)
glm_diagnosis_m <- add_criterion(glm_diagnosis_m, criterion=c("waic","loo","R2"),file = "models/glm_diagnosis_m")

## By group
glm_f = bf(ChoiceRed ~ bias + 
             bSelf * Self + 
             bOthers * (lOthers1noC + lOthers2noC + lOthers3noC + lOthers4noC) +
             bConfidence * (Confidence1 * lOthers1noC + Confidence2 * lOthers2noC + Confidence3 * lOthers3noC + Confidence4 * lOthers4noC),
             bSelf + bOthers + bConfidence + bias ~ 1 + (1 | p | Participant) ,
             nl = TRUE)


glm_prior = c(
  prior(normal(0, .1), nlpar = "bias"),
  prior(normal(0, 1), nlpar = "bSelf"),
  prior(normal(0, 1), nlpar = "bOthers"),
  prior(normal(0, 1), nlpar = "bConfidence"),
  prior(normal(0, .1), nlpar = "bias", class="sd"),
  prior(normal(0, .5), nlpar = "bSelf", class="sd"),
  prior(normal(0, .5), nlpar = "bOthers", class="sd"),
  prior(normal(0, .5), nlpar = "bConfidence", class="sd"))

glm_schizophrenia_m = brm(glm_f,
             family="bernoulli",
             data = subset(full_data,Diagnosis==1),
             prior = glm_prior,
             sample_prior = TRUE,
             file = "models/glm_schizophrenia_m",
             chains = N_CORES, cores = N_CORES, iter = ITER,
             control = STAN_CONTROL)
glm_schizophrenia_m <- add_criterion(glm_schizophrenia_m, criterion=c("waic","loo","R2"),file = "models/glm_schizophrenia_m")

glm_controls_m = brm(glm_f,
             family="bernoulli",
             data = subset(full_data,Diagnosis==0),
             prior = glm_prior,
             sample_prior = TRUE,
             file = "models/glm_controls_m",
             chains = N_CORES, cores = N_CORES, iter = ITER,
             control = STAN_CONTROL)
glm_controls_m <- add_criterion(glm_controls_m, criterion=c("waic","loo","R2"), file = "models/glm_controls_m")

```


# Model comparison

Now, are we warranted in moving on to the most complex model (Circular Inference)?
A first intuition would be to look at the parameters in the Circular Inference model. If the loop strength is equal to zero = exp(-inf), the model makes the same predictions as the simpler weighted model. And if the weights are equal to one = inv_logit_scaled(+inf, 0.5, 1), the predictions are equal to the simplest naive bayes model. But this approach doesn't penalize the more complex model for its complexity.

Instead, we'll use information criteria (PSIS-LOO) to do model comparison. 

```{r Model Comparison}

Looic_comparison <- loo_compare(naive_diagnosis_m, weighted_diagnosis_m, circular_diagnosis_m, glm_diagnosis_m, criterion="loo")

Looic_weights <- loo_model_weights(naive_diagnosis_m, weighted_diagnosis_m, circular_diagnosis_m, glm_diagnosis_m, criterion="loo")

```

## Reporting the best model

```{r Model Report}

summary(circular_diagnosis_m)

hypothesis(circular_diagnosis_m,"wSelf_Diagnosis > 0")
plot(hypothesis(circular_diagnosis_m,"wSelf_Diagnosis > 0"))
hypothesis(circular_diagnosis_m,"wOthers_Diagnosis < 0")
plot(hypothesis(circular_diagnosis_m,"wOthers_Diagnosis < 0"))
hypothesis(circular_diagnosis_m,"aSelf_Diagnosis > 0")
plot(hypothesis(circular_diagnosis_m,"aSelf_Diagnosis > 0"))
hypothesis(circular_diagnosis_m,"aOthers_Diagnosis < 0")
plot(hypothesis(circular_diagnosis_m,"aOthers_Diagnosis < 0"))

```

## Cognitive features and symptom models

```{r Cognitive Clinical Models}

# IQ model
circular_IQ_f = bf(ChoiceRed ~ bias + 
                   F(0, lSelf + I, wSelf) +
                   F(0, lOthers1noC + I, wOthers + bConfidence * Confidence1) +
                   F(0, lOthers2noC + I, wOthers + bConfidence * Confidence2) +
                   F(0, lOthers3noC + I, wOthers + bConfidence * Confidence3) +
                   F(0, lOthers4noC + I, wOthers + bConfidence * Confidence4),
               wSelf + wOthers + aSelf + aOthers + bConfidence ~ 1 + IQs + (1|p|Participant),
               bias ~ 1 + (1|Participant),
               nlf(I ~ F(aSelf, lSelf, wSelf) +
                          F(aOthers, lOthers1noC, wOthers + bConfidence * Confidence1) +
                          F(aOthers, lOthers2noC, wOthers + bConfidence * Confidence2) +
                          F(aOthers, lOthers3noC, wOthers + bConfidence * Confidence3) +
                          F(aOthers, lOthers4noC, wOthers + bConfidence * Confidence4)),
               nl = TRUE)

circular_prior = c(prior(normal(0,.3), nlpar = "wSelf"),
                   prior(normal(0,.3), nlpar = "wOthers"),
                   prior(normal(0,.3), nlpar = "aSelf"),
                   prior(normal(0,.3), nlpar = "aOthers"),
                   prior(normal(0,.1), nlpar = "bias"),
                   prior(normal(1,1), nlpar = "wSelf", coef = "Intercept"),
                   prior(normal(1,1), nlpar = "wOthers", coef = "Intercept"),
                   prior(normal(0,1), nlpar = "aSelf", coef = "Intercept"),
                   prior(normal(0,1), nlpar = "aOthers", coef = "Intercept"),
                   prior(normal(0,.2), coef="IQs", nlpar = "wSelf"),
                   prior(normal(0,.2), coef="IQs", nlpar = "wOthers"),
                   prior(normal(0,.2), coef="IQs", nlpar = "aSelf"),
                   prior(normal(0,.2), coef="IQs", nlpar = "aOthers"),
                   prior(normal(0, .2), nlpar = "wSelf",class="sd"),
                   prior(normal(0, .2), nlpar = "wOthers",class="sd"),
                   prior(normal(0, .2), nlpar = "aSelf",class="sd"),
                   prior(normal(0, .2), nlpar = "aOthers",class="sd"),
                   prior(normal(0, .2), nlpar = "bias",class="sd"),
                   prior(normal(1,.3), nlpar = "bConfidence"),
                   prior(normal(0, .2), nlpar = "bConfidence",class="sd"),
                   prior_("lkj(5)", class = "cor"))

circular_IQ_m = fit_brm(circular_IQ_f,
               subset(full_data,Diagnosis==1),
               stan_funs = F_stancode,
               prior = circular_prior,
               sample_prior = TRUE,
               family = "bernoulli",
               ,
               chains = N_CORES, cores = N_CORES, iter = ITER,refresh=100,
               control = STAN_CONTROL)

circular_IQ_m <- add_criterion(circular_IQ_m, criterion=c("waic","loo","R2"),file = "models/circular_IQ_m")

## Same evidence for effects of IQ so we run a full analysis

circular_diagnosisIQ_f = bf(ChoiceRed ~ bias + 
                   F(0, lSelf + I, wSelf) +
                   F(0, lOthers1noC + I, wOthers + bConfidence * Confidence1) +
                   F(0, lOthers2noC + I, wOthers + bConfidence * Confidence2) +
                   F(0, lOthers3noC + I, wOthers + bConfidence * Confidence3) +
                   F(0, lOthers4noC + I, wOthers + bConfidence * Confidence4),
               wSelf + aSelf + wOthers + aOthers + bConfidence + bias ~ 1 + Diagnosis + IQs + (1 + Diagnosis +  IQs | p | SubjectPair) ,
               nlf(I ~ F(aSelf, lSelf, wSelf) +
                          F(aOthers, lOthers1noC, wOthers + bConfidence * Confidence1) +
                          F(aOthers, lOthers2noC, wOthers + bConfidence * Confidence2) +
                          F(aOthers, lOthers3noC, wOthers + bConfidence * Confidence3) +
                          F(aOthers, lOthers4noC, wOthers + bConfidence * Confidence4)),
               nl = TRUE)

circular_prior = c(prior(normal(0,.3), nlpar = "wSelf"),
                   prior(normal(0,.3), nlpar = "wOthers"),
                   prior(normal(0,.3), nlpar = "aSelf"),
                   prior(normal(0,.3), nlpar = "aOthers"),
                   prior(normal(1,.5), nlpar = "bConfidence"),
                   prior(normal(0,.1), nlpar = "bias"),
                   prior(normal(1,1), nlpar = "wSelf", coef = "Intercept"),
                   prior(normal(1,1), nlpar = "wOthers", coef = "Intercept"),
                   prior(normal(0,1), nlpar = "aSelf", coef = "Intercept"),
                   prior(normal(0,1), nlpar = "aOthers", coef = "Intercept"),
                   prior(normal(0, .2), nlpar = "wSelf",class="sd"),
                   prior(normal(0, .2), nlpar = "wOthers",class="sd"),
                   prior(normal(0, .2), nlpar = "aSelf",class="sd"),
                   prior(normal(0, .2), nlpar = "aOthers",class="sd"),
                   prior(normal(0, .2), nlpar = "bConfidence",class="sd"),
                   prior(normal(0, .2), nlpar = "bias",class="sd"),
                   prior_("lkj(8)", class = "cor"))

circular_diagnosisIQ_m = fit_brm(circular_diagnosisIQ_f,
               full_data,
               stan_funs = F_stancode,
               prior = circular_prior,
               sample_prior = TRUE,
               family = "bernoulli",
               file = "models/circular_diagnosisIQ_m",
               chains = N_CORES, cores = N_CORES, iter = ITER, refresh = 20,
               control = STAN_CONTROL)

circular_diagnosisIQ_m <- add_criterion(circular_diagnosisIQ_m, criterion=c("waic","loo","R2"),file = "models/circular_diagnosisIQ_m")


# WM model
circular_WM_f = bf(ChoiceRed ~ bias + 
                   F(0, lSelf + I, wSelf) +
                   F(0, lOthers1noC + I, wOthers + bConfidence * Confidence1) +
                   F(0, lOthers2noC + I, wOthers + bConfidence * Confidence2) +
                   F(0, lOthers3noC + I, wOthers + bConfidence * Confidence3) +
                   F(0, lOthers4noC + I, wOthers + bConfidence * Confidence4),
               wSelf + wOthers + aSelf + aOthers + bConfidence ~ 1 + WM_Errors + (1|p|Participant),
               bias ~ 1 + (1|Participant),
               nlf(I ~ F(aSelf, lSelf, wSelf) +
                          F(aOthers, lOthers1noC, wOthers + bConfidence * Confidence1) +
                          F(aOthers, lOthers2noC, wOthers + bConfidence * Confidence2) +
                          F(aOthers, lOthers3noC, wOthers + bConfidence * Confidence3) +
                          F(aOthers, lOthers4noC, wOthers + bConfidence * Confidence4)),
               nl = TRUE)

circular_prior = c(
  prior(normal(0,.3), nlpar = "wSelf"),
  prior(normal(0,.3), nlpar = "wOthers"),
  prior(normal(0,.3), nlpar = "aSelf"),
  prior(normal(0,.3), nlpar = "aOthers"),
  prior(normal(0,.1), nlpar = "bias"),
  prior(normal(1,.2), nlpar = "bConfidence"),
  prior(normal(1,1.5), nlpar = "wSelf", coef = "Intercept"),
  prior(normal(1,1.5), nlpar = "wOthers", coef = "Intercept"),
  prior(normal(0,1.5), nlpar = "aSelf", coef = "Intercept"),
  prior(normal(0,1.5), nlpar = "aOthers", coef = "Intercept"),
  prior(normal(0,.2), coef="WM_Errors", nlpar = "wSelf"),
  prior(normal(0,.2), coef="WM_Errors", nlpar = "wOthers"),
  prior(normal(0,.2), coef="WM_Errors", nlpar = "aSelf"),
  prior(normal(0,.2), coef="WM_Errors", nlpar = "aOthers"),
  prior(normal(0,.2), coef="WM_Errors", nlpar = "bConfidence"),
  prior(normal(0, .2), nlpar = "wSelf",class="sd"),
  prior(normal(0, .2), nlpar = "wOthers",class="sd"),
  prior(normal(0, .2), nlpar = "aSelf",class="sd"),
  prior(normal(0, .2), nlpar = "aOthers",class="sd"),
  prior(normal(0, .2), nlpar = "bConfidence",class="sd"),
  prior(normal(0, .2), nlpar = "bias",class="sd"),
  prior_("lkj(8)", class = "cor"))

circular_WM_m = fit_brm(circular_WM_f,
               subset(full_data,Diagnosis==1),
               stan_funs = F_stancode,
               prior = circular_confidence_prior,
               sample_prior = TRUE,
               family = "bernoulli", 
               file = "models/circular_WM_m",
               chains = N_CORES, cores = N_CORES, iter = ITER,
               control = STAN_CONTROL)

circular_WM_m <- add_criterion(circular_WM_m,
                               criterion=c("waic","loo","R2"), file = "models/circular_WM_m")


# IED model
circular_IED_f = bf(ChoiceRed ~ bias + 
                   F(0, lSelf + I, wSelf) +
                   F(0, lOthers1noC + I, wOthers + bConfidence * Confidence1) +
                   F(0, lOthers2noC + I, wOthers + bConfidence * Confidence2) +
                   F(0, lOthers3noC + I, wOthers + bConfidence * Confidence3) +
                   F(0, lOthers4noC + I, wOthers + bConfidence * Confidence4),
               wSelf + wOthers + aSelf + aOthers + bConfidence ~ 1 + IED_Errors + (1|p|Participant),
               bias ~ 1 + (1|Participant),
               nlf(I ~ F(aSelf, lSelf, wSelf) +
                          F(aOthers, lOthers1noC, wOthers + bConfidence * Confidence1) +
                          F(aOthers, lOthers2noC, wOthers + bConfidence * Confidence2) +
                          F(aOthers, lOthers3noC, wOthers + bConfidence * Confidence3) +
                          F(aOthers, lOthers4noC, wOthers + bConfidence * Confidence4)),
               nl = TRUE)

circular_confidence_prior = c(
  prior(normal(0,.3), nlpar = "wSelf"),
  prior(normal(0,.3), nlpar = "wOthers"),
  prior(normal(0,.3), nlpar = "aSelf"),
  prior(normal(0,.3), nlpar = "aOthers"),
  prior(normal(0,.1), nlpar = "bias"),
  prior(normal(1,.2), nlpar = "bConfidence"),
  prior(normal(1,1.5), nlpar = "wSelf", coef = "Intercept"),
  prior(normal(1,1.5), nlpar = "wOthers", coef = "Intercept"),
  prior(normal(0,1.5), nlpar = "aSelf", coef = "Intercept"),
  prior(normal(0,1.5), nlpar = "aOthers", coef = "Intercept"),
  prior(normal(0,.2), coef="IED_Errors", nlpar = "wSelf"),
  prior(normal(0,.2), coef="IED_Errors", nlpar = "wOthers"),
  prior(normal(0,.2), coef="IED_Errors", nlpar = "aSelf"),
  prior(normal(0,.2), coef="IED_Errors", nlpar = "aOthers"),
  prior(normal(0,.2), coef="IED_Errors", nlpar = "bConfidence"),
  prior(normal(0, .2), nlpar = "wSelf",class="sd"),
  prior(normal(0, .2), nlpar = "wOthers",class="sd"),
  prior(normal(0, .2), nlpar = "aSelf",class="sd"),
  prior(normal(0, .2), nlpar = "aOthers",class="sd"),
  prior(normal(0, .2), nlpar = "bConfidence",class="sd"),
  prior(normal(0, .2), nlpar = "bias",class="sd"),
  prior_("lkj(8)", class = "cor"))

circular_IED_m = fit_brm(circular_IED_f,
               subset(full_data,Diagnosis==1),
               stan_funs = F_stancode,
               prior = circular_confidence_prior,
               sample_prior = TRUE,
               family = "bernoulli",
               file = "models/circular_IED_m",
               chains = N_CORES, cores = N_CORES, iter = ITER,
               control = STAN_CONTROL)

circular_IED_m <- add_criterion(circular_IED_m, criterion=c("waic","loo","R2"), file = "models/circular_IED_m")

# CPZ model
circular_CPZ_f = bf(ChoiceRed ~ bias + 
                   F(0, lSelf + I, wSelf) +
                   F(0, lOthers1noC + I, wOthers + bConfidence * Confidence1) +
                   F(0, lOthers2noC + I, wOthers + bConfidence * Confidence2) +
                   F(0, lOthers3noC + I, wOthers + bConfidence * Confidence3) +
                   F(0, lOthers4noC + I, wOthers + bConfidence * Confidence4),
               wSelf + wOthers + aSelf + aOthers + bConfidence ~ 1 + CPZ + (1|p|Participant),
               bias ~ 1 + (1|Participant),
               nlf(I ~ F(aSelf, lSelf, wSelf) +
                          F(aOthers, lOthers1noC, wOthers + bConfidence * Confidence1) +
                          F(aOthers, lOthers2noC, wOthers + bConfidence * Confidence2) +
                          F(aOthers, lOthers3noC, wOthers + bConfidence * Confidence3) +
                          F(aOthers, lOthers4noC, wOthers + bConfidence * Confidence4)),
               nl = TRUE)

circular_prior = c(
  prior(normal(0,.3), nlpar = "wSelf"),
  prior(normal(0,.3), nlpar = "wOthers"),
  prior(normal(0,.3), nlpar = "aSelf"),
  prior(normal(0,.3), nlpar = "aOthers"),
  prior(normal(0,.1), nlpar = "bias"),
  prior(normal(1,.2), nlpar = "bConfidence"),
  prior(normal(1,1.5), nlpar = "wSelf", coef = "Intercept"),
  prior(normal(1,1.5), nlpar = "wOthers", coef = "Intercept"),
  prior(normal(0,1.5), nlpar = "aSelf", coef = "Intercept"),
  prior(normal(0,1.5), nlpar = "aOthers", coef = "Intercept"),
  prior(normal(0,.2), coef="CPZ", nlpar = "wSelf"),
  prior(normal(0,.2), coef="CPZ", nlpar = "wOthers"),
  prior(normal(0,.2), coef="CPZ", nlpar = "aSelf"),
  prior(normal(0,.2), coef="CPZ", nlpar = "aOthers"),
  prior(normal(0,.2), coef="CPZ", nlpar = "bConfidence"),
  prior(normal(0, .2), nlpar = "wSelf",class="sd"),
  prior(normal(0, .2), nlpar = "wOthers",class="sd"),
  prior(normal(0, .2), nlpar = "aSelf",class="sd"),
  prior(normal(0, .2), nlpar = "aOthers",class="sd"),
  prior(normal(0, .2), nlpar = "bConfidence",class="sd"),
  prior(normal(0, .2), nlpar = "bias",class="sd"),
  prior_("lkj(8)", class = "cor"))

circular_CPZ_m = fit_brm(circular_CPZ_f,
               subset(full_data,Diagnosis==1),
               stan_funs = F_stancode,
               prior = circular_confidence_prior,
               sample_prior = TRUE,
               family = "bernoulli",
               file = "models/circular_CPZ_m",
               chains = N_CORES, cores = N_CORES, iter = ITER,
               control = STAN_CONTROL)

circular_CPZ_m <- add_criterion(circular_CPZ_m, criterion=c("waic","loo","R2"), file = "models/circular_CPZ_m")

# SANS model
circular_SANS_f = bf(ChoiceRed ~ bias + 
                   F(0, lSelf + I, wSelf) +
                   F(0, lOthers1noC + I, wOthers + bConfidence * Confidence1) +
                   F(0, lOthers2noC + I, wOthers + bConfidence * Confidence2) +
                   F(0, lOthers3noC + I, wOthers + bConfidence * Confidence3) +
                   F(0, lOthers4noC + I, wOthers + bConfidence * Confidence4),
               wSelf + wOthers + aSelf + aOthers + bConfidence ~ 1 + SANSs + (1|p|Participant),
               bias ~ 1 + (1|Participant),
               nlf(I ~ F(aSelf, lSelf, wSelf) +
                          F(aOthers, lOthers1noC, wOthers + bConfidence * Confidence1) +
                          F(aOthers, lOthers2noC, wOthers + bConfidence * Confidence2) +
                          F(aOthers, lOthers3noC, wOthers + bConfidence * Confidence3) +
                          F(aOthers, lOthers4noC, wOthers + bConfidence * Confidence4)),
               nl = TRUE)

circular_prior = c(
  prior(normal(0,.3), nlpar = "wSelf"),
  prior(normal(0,.3), nlpar = "wOthers"),
  prior(normal(0,.3), nlpar = "aSelf"),
  prior(normal(0,.3), nlpar = "aOthers"),
  prior(normal(0,.1), nlpar = "bias"),
  prior(normal(1,.2), nlpar = "bConfidence"),
  prior(normal(1,1.5), nlpar = "wSelf", coef = "Intercept"),
  prior(normal(1,1.5), nlpar = "wOthers", coef = "Intercept"),
  prior(normal(0,1.5), nlpar = "aSelf", coef = "Intercept"),
  prior(normal(0,1.5), nlpar = "aOthers", coef = "Intercept"),
  prior(normal(0,.2), coef="SANSs", nlpar = "wSelf"),
  prior(normal(0,.2), coef="SANSs", nlpar = "wOthers"),
  prior(normal(0,.2), coef="SANSs", nlpar = "aSelf"),
  prior(normal(0,.2), coef="SANSs", nlpar = "aOthers"),
  prior(normal(0,.2), coef="SANSs", nlpar = "bConfidence"),
  prior(normal(0, .2), nlpar = "wSelf",class="sd"),
  prior(normal(0, .2), nlpar = "wOthers",class="sd"),
  prior(normal(0, .2), nlpar = "aSelf",class="sd"),
  prior(normal(0, .2), nlpar = "aOthers",class="sd"),
  prior(normal(0, .2), nlpar = "bConfidence",class="sd"),
  prior(normal(0, .2), nlpar = "bias",class="sd"),
  prior_("lkj(8)", class = "cor"))

circular_SANS_m = fit_brm(circular_SANS_f,
               subset(full_data,Diagnosis==1),
               stan_funs = F_stancode,
               prior = circular_confidence_prior,
               sample_prior = TRUE,
               family = "bernoulli", 
               file = "models/circular_SANS_m",
               chains = N_CORES, cores = N_CORES, iter = ITER, refresh=20,
               control = STAN_CONTROL)

circular_SANS_m <- add_criterion(circular_SANS_m, criterion=c("waic","loo","R2"),file = "models/circular_SANS_m")

# SAPS model
circular_SAPS_f = bf(ChoiceRed ~ bias + 
                   F(0, lSelf + I, wSelf) +
                   F(0, lOthers1noC + I, wOthers + bConfidence * Confidence1) +
                   F(0, lOthers2noC + I, wOthers + bConfidence * Confidence2) +
                   F(0, lOthers3noC + I, wOthers + bConfidence * Confidence3) +
                   F(0, lOthers4noC + I, wOthers + bConfidence * Confidence4),
               wSelf + wOthers + aSelf + aOthers + bConfidence ~ 1 + SAPSs + (1|p|Participant),
               bias ~ 1 + (1|Participant),
               nlf(I ~ F(aSelf, lSelf, wSelf) +
                          F(aOthers, lOthers1noC, wOthers + bConfidence * Confidence1) +
                          F(aOthers, lOthers2noC, wOthers + bConfidence * Confidence2) +
                          F(aOthers, lOthers3noC, wOthers + bConfidence * Confidence3) +
                          F(aOthers, lOthers4noC, wOthers + bConfidence * Confidence4)),
               nl = TRUE)

circular_prior = c(
  prior(normal(0,.3), nlpar = "wSelf"),
  prior(normal(0,.3), nlpar = "wOthers"),
  prior(normal(0,.3), nlpar = "aSelf"),
  prior(normal(0,.3), nlpar = "aOthers"),
  prior(normal(0,.1), nlpar = "bias"),
  prior(normal(1,.2), nlpar = "bConfidence"),
  prior(normal(1,1.5), nlpar = "wSelf", coef = "Intercept"),
  prior(normal(1,1.5), nlpar = "wOthers", coef = "Intercept"),
  prior(normal(0,1.5), nlpar = "aSelf", coef = "Intercept"),
  prior(normal(0,1.5), nlpar = "aOthers", coef = "Intercept"),
  prior(normal(0,.2), coef="SAPSs", nlpar = "wSelf"),
  prior(normal(0,.2), coef="SAPSs", nlpar = "wOthers"),
  prior(normal(0,.2), coef="SAPSs", nlpar = "aSelf"),
  prior(normal(0,.2), coef="SAPSs", nlpar = "aOthers"),
  prior(normal(0,.2), coef="SAPSs", nlpar = "bConfidence"),
  prior(normal(0, .2), nlpar = "wSelf",class="sd"),
  prior(normal(0, .2), nlpar = "wOthers",class="sd"),
  prior(normal(0, .2), nlpar = "aSelf",class="sd"),
  prior(normal(0, .2), nlpar = "aOthers",class="sd"),
  prior(normal(0, .2), nlpar = "bConfidence",class="sd"),
  prior(normal(0, .2), nlpar = "bias",class="sd"),
  prior_("lkj(8)", class = "cor"))

circular_SAPS_m = fit_brm(circular_SAPS_f,
               subset(full_data,Diagnosis==1),
               stan_funs = F_stancode,
               prior = circular_confidence_prior,
               sample_prior = TRUE,
               family = "bernoulli",
               file = "models/circular_SAPS_m",
               chains = N_CORES, cores = N_CORES, iter = ITER, refresh=100,
               control = STAN_CONTROL)

circular_SAPS_m <- add_criterion(circular_SAPS_m, criterion=c("waic","loo","R2"), file = "models/circular_SAPS_m")

# PSP model
circular_PSP_f = bf(ChoiceRed ~ bias + 
                   F(0, lSelf + I, wSelf) +
                   F(0, lOthers1noC + I, wOthers + bConfidence * Confidence1) +
                   F(0, lOthers2noC + I, wOthers + bConfidence * Confidence2) +
                   F(0, lOthers3noC + I, wOthers + bConfidence * Confidence3) +
                   F(0, lOthers4noC + I, wOthers + bConfidence * Confidence4),
               wSelf + wOthers + aSelf + aOthers + bConfidence ~ 1 + PSPs_schizo + (1|p|Participant),
               bias ~ 1 + (1|Participant),
               nlf(I ~ F(aSelf, lSelf, wSelf) +
                          F(aOthers, lOthers1noC, wOthers + bConfidence * Confidence1) +
                          F(aOthers, lOthers2noC, wOthers + bConfidence * Confidence2) +
                          F(aOthers, lOthers3noC, wOthers + bConfidence * Confidence3) +
                          F(aOthers, lOthers4noC, wOthers + bConfidence * Confidence4)),
               nl = TRUE)

circular_prior = c(
  prior(normal(0,.3), nlpar = "wSelf"),
  prior(normal(0,.3), nlpar = "wOthers"),
  prior(normal(0,.3), nlpar = "aSelf"),
  prior(normal(0,.3), nlpar = "aOthers"),
  prior(normal(0,.1), nlpar = "bias"),
  prior(normal(1,.2), nlpar = "bConfidence"),
  prior(normal(1,1.5), nlpar = "wSelf", coef = "Intercept"),
  prior(normal(1,1.5), nlpar = "wOthers", coef = "Intercept"),
  prior(normal(0,1.5), nlpar = "aSelf", coef = "Intercept"),
  prior(normal(0,1.5), nlpar = "aOthers", coef = "Intercept"),
  prior(normal(0,.2), coef="PSPs_schizo", nlpar = "wSelf"),
  prior(normal(0,.2), coef="PSPs_schizo", nlpar = "wOthers"),
  prior(normal(0,.2), coef="PSPs_schizo", nlpar = "aSelf"),
  prior(normal(0,.2), coef="PSPs_schizo", nlpar = "aOthers"),
  prior(normal(0,.2), coef="PSPs_schizo", nlpar = "bConfidence"),
  prior(normal(0, .2), nlpar = "wSelf",class="sd"),
  prior(normal(0, .2), nlpar = "wOthers",class="sd"),
  prior(normal(0, .2), nlpar = "aSelf",class="sd"),
  prior(normal(0, .2), nlpar = "aOthers",class="sd"),
  prior(normal(0, .2), nlpar = "bConfidence",class="sd"),
  prior(normal(0, .2), nlpar = "bias",class="sd"),
  prior_("lkj(8)", class = "cor"))

circular_PSP_m = fit_brm(circularPSP_f,
               subset(full_data,Diagnosis==1),
               stan_funs = F_stancode,
               prior = circular_prior,
               sample_prior = TRUE,
               family = "bernoulli", 
               file = "models/circular_PSP_m",
               chains = N_CORES, cores = N_CORES, iter = ITER,
               control = STAN_CONTROL)

circular_PSP_m <- add_criterion(circular_PSP_m, criterion=c("waic","loo","R2"),file = "models/circular_PSP_m")

```

## Model comparisons to assess the role of clinical and cognitive features

```{r}

load("models/circular_schizo_confidence_baseline_m")
load("models/circular_IQ_m")
load("models/circular_WM_m")
load("models/circular_IED_m")
load("models/circular_CPZ_m")
load("models/circular_SANS_m")
load("models/circular_SAPS_m")
load("models/circular_PSP_m")

loo_compare(circular_schizo_confidence_baseline_m, circular_IQ_m, criterion="loo")
model_weights(circular_schizo_confidence_baseline_m, circular_IQ_m, criterion="loo")
summary(circular_IQ_m)
hypothesis(circular_IQ_m,"wSelf_IQs < 0")
hypothesis(circular_IQ_m,"wOthers_IQs > 0")
hypothesis(circular_IQ_m,"aSelf_IQs < 0")
hypothesis(circular_IQ_m,"aOthers_IQs > 0")
# Calculate estimates
post <- posterior_samples(circular_IQ_m)
bias <- c(post$b_bias_Intercept, post$b_bias_Intercept)
bConfidence <- c(post$b_bConfidence_Intercept, post$b_bConfidence_Intercept + post$b_bConfidence_IQs)
wSelf <- c(post$b_wSelf_Intercept, post$b_wSelf_Intercept + post$b_wSelf_IQs)
wOthers <- c(post$b_wOthers_Intercept, post$b_wOthers_Intercept + post$b_wOthers_IQs)
aSelf <- c(post$b_aSelf_Intercept, post$b_aSelf_Intercept + post$b_aSelf_IQs)
aOthers <- c(post$b_aOthers_Intercept, post$b_aOthers_Intercept + post$b_aOthers_IQs)
IQ <- c(  rep(0,each=8000),  rep(1,each=8000)) 
xxx <- data.frame(IQ,wSelf,wOthers,aSelf,aOthers,bias,bConfidence)
Pars <- xxx %>% group_by(IQ) %>% dplyr::summarize(wSelf=mean(wSelf),wOthers=mean(wOthers),aSelf=mean(aSelf),aOthers=mean(aOthers),bias=mean(bias),bConfidence=mean(bConfidence))
Pars$wSelf_scale <- inv_logit_scaled(Pars$wSelf, 0.5, 1)
Pars$wOthers_scale <- inv_logit_scaled(Pars$wOthers + Pars$bConfidence, 0.5, 1)
Pars$wOthersLowConf_scale <- inv_logit_scaled(Pars$wOthers + (Pars$bConfidence*0.5), 0.5, 1)
Pars$aSelf_scale <- exp(Pars$aSelf)
Pars$aOthers_scale <- exp(Pars$aOthers)
#
summary(circular_diagnosisIQ_m)
hypothesis(circular_diagnosisIQ_m,"wSelf_Diagnosis > 0")
hypothesis(circular_diagnosisIQ_m,"wOthers_Diagnosis < 0")
hypothesis(circular_diagnosisIQ_m,"aSelf_Diagnosis > 0")
hypothesis(circular_diagnosisIQ_m,"aOthers_Diagnosis < 0")

loo_compare(circular_schizo_confidence_baseline_m, circular_WM_m, criterion="loo")
model_weights(circular_schizo_confidence_baseline_m, circular_WM_m, criterion="loo")
summary(circular_WM_m)
hypothesis(circular_WM_m,"wSelf_WM_Errors < 0")
hypothesis(circular_WM_m,"wOthers_WM_Errors > 0")
hypothesis(circular_WM_m,"aSelf_WM_Errors < 0")
hypothesis(circular_WM_m,"aOthers_WM_Errors > 0")

post <- posterior_samples(circular_WM_m)
bias <- c(post$b_bias_Intercept, post$b_bias_Intercept)
bConfidence <- c(post$b_bConfidence_Intercept, post$b_bConfidence_Intercept + post$b_bConfidence_WM_Errors)
wSelf <- c(post$b_wSelf_Intercept, post$b_wSelf_Intercept + post$b_wSelf_WM_Errors)
wOthers <- c(post$b_wOthers_Intercept, post$b_wOthers_Intercept + post$b_wOthers_WM_Errors)
aSelf <- c(post$b_aSelf_Intercept, post$b_aSelf_Intercept + post$b_aSelf_WM_Errors)
aOthers <- c(post$b_aOthers_Intercept, post$b_aOthers_Intercept + post$b_aOthers_WM_Errors)
WM <- c(  rep(0,each=8000),  rep(1,each=8000)) 
xxx <- data.frame(WM,wSelf,wOthers,aSelf,aOthers,bias,bConfidence)
Pars <- xxx %>% group_by(WM) %>% dplyr::summarize(wSelf=mean(wSelf),wOthers=mean(wOthers),aSelf=mean(aSelf),aOthers=mean(aOthers),bias=mean(bias),bConfidence=mean(bConfidence))
Pars$wSelf_scale <- inv_logit_scaled(Pars$wSelf, 0.5, 1)
Pars$wOthers_scale <- inv_logit_scaled(Pars$wOthers + Pars$bConfidence, 0.5, 1)
Pars$wOthersLowConf_scale <- inv_logit_scaled(Pars$wOthers + (Pars$bConfidence*0.5), 0.5, 1)
Pars$aSelf_scale <- exp(Pars$aSelf)
Pars$aOthers_scale <- exp(Pars$aOthers)


loo_compare(circular_schizo_confidence_baseline_m, circular_IED_m, criterion="loo")
model_weights(circular_schizo_confidence_baseline_m, circular_IED_m, criterion="loo")
summary(circular_IED_m)
hypothesis(circular_IED_m,"wSelf_IED_Errors < 0")
hypothesis(circular_IED_m,"wOthers_IED_Errors > 0")
hypothesis(circular_IED_m,"aSelf_IED_Errors < 0")
hypothesis(circular_IED_m,"aOthers_IED_Errors > 0")
post <- posterior_samples(circular_IED_m)
bias <- c(post$b_bias_Intercept, post$b_bias_Intercept)
bConfidence <- c(post$b_bConfidence_Intercept, post$b_bConfidence_Intercept + post$b_bConfidence_IED_Errors)
wSelf <- c(post$b_wSelf_Intercept, post$b_wSelf_Intercept + post$b_wSelf_IED_Errors)
wOthers <- c(post$b_wOthers_Intercept, post$b_wOthers_Intercept + post$b_wOthers_IED_Errors)
aSelf <- c(post$b_aSelf_Intercept, post$b_aSelf_Intercept + post$b_aSelf_IED_Errors)
aOthers <- c(post$b_aOthers_Intercept, post$b_aOthers_Intercept + post$b_aOthers_IED_Errors)
IED <- c(  rep(0,each=8000),  rep(1,each=8000)) 
xxx <- data.frame(IED,wSelf,wOthers,aSelf,aOthers,bias,bConfidence)
Pars <- xxx %>% group_by(IED) %>% dplyr::summarize(wSelf=mean(wSelf),wOthers=mean(wOthers),aSelf=mean(aSelf),aOthers=mean(aOthers),bias=mean(bias),bConfidence=mean(bConfidence))
Pars$wSelf_scale <- inv_logit_scaled(Pars$wSelf, 0.5, 1)
Pars$wOthers_scale <- inv_logit_scaled(Pars$wOthers + Pars$bConfidence, 0.5, 1)
Pars$wOthersLowConf_scale <- inv_logit_scaled(Pars$wOthers + (Pars$bConfidence*0.5), 0.5, 1)
Pars$aSelf_scale <- exp(Pars$aSelf)
Pars$aOthers_scale <- exp(Pars$aOthers)


loo_compare(circular_schizo_confidence_baseline_m, circular_CPZ_m, criterion="loo")
model_weights(circular_schizo_confidence_baseline_m, circular_CPZ_m, criterion="loo")
summary(circular_CPZ_m)
hypothesis(circular_CPZ_m,"wSelf_CPZ > 0")
hypothesis(circular_CPZ_m,"wOthers_CPZ < 0")
hypothesis(circular_CPZ_m,"aSelf_CPZ > 0")
hypothesis(circular_CPZ_m,"aOthers_CPZ < 0")
# Calculate estimates
post <- posterior_samples(circular_CPZ_m)
bias <- c(post$b_bias_Intercept, post$b_bias_Intercept)
bConfidence <- c(post$b_bConfidence_Intercept, post$b_bConfidence_Intercept + post$b_bConfidence_CPZ)
wSelf <- c(post$b_wSelf_Intercept, post$b_wSelf_Intercept + post$b_wSelf_CPZ)
wOthers <- c(post$b_wOthers_Intercept, post$b_wOthers_Intercept + post$b_wOthers_CPZ)
aSelf <- c(post$b_aSelf_Intercept, post$b_aSelf_Intercept + post$b_aSelf_CPZ)
aOthers <- c(post$b_aOthers_Intercept, post$b_aOthers_Intercept + post$b_aOthers_CPZ)
CPZ <- c(  rep(0,each=8000),  rep(1,each=8000)) 
xxx <- data.frame(CPZ,wSelf,wOthers,aSelf,aOthers,bias,bConfidence)
Pars <- xxx %>% group_by(CPZ) %>% dplyr::summarize(wSelf=mean(wSelf),wOthers=mean(wOthers),aSelf=mean(aSelf),aOthers=mean(aOthers),bias=mean(bias),bConfidence=mean(bConfidence))
Pars$wSelf_scale <- inv_logit_scaled(Pars$wSelf, 0.5, 1)
Pars$wOthers_scale <- inv_logit_scaled(Pars$wOthers + Pars$bConfidence, 0.5, 1)
Pars$wOthersLowConf_scale <- inv_logit_scaled(Pars$wOthers + (Pars$bConfidence*0.5), 0.5, 1)
Pars$aSelf_scale <- exp(Pars$aSelf)
Pars$aOthers_scale <- exp(Pars$aOthers)

loo_compare(circular_schizo_confidence_baseline_m, circular_sans_m, criterion="loo")
model_weights(circular_schizo_confidence_baseline_m, circular_sans_m, criterion="loo")
summary(circular_sans_m)
hypothesis(circular_sans_m,"wSelf_SANSs > 0")
hypothesis(circular_sans_m,"wOthers_SANSs < 0")
hypothesis(circular_sans_m,"aSelf_SANSs > 0")
hypothesis(circular_sans_m,"aOthers_SANSs < 0")
# Calculate estimates
post <- posterior_samples(circular_sans_m)
bias <- c(post$b_bias_Intercept, post$b_bias_Intercept)
bConfidence <- c(post$b_bConfidence_Intercept, post$b_bConfidence_Intercept + post$b_bConfidence_SANSs)
wSelf <- c(post$b_wSelf_Intercept, post$b_wSelf_Intercept + post$b_wSelf_SANSs)
wOthers <- c(post$b_wOthers_Intercept, post$b_wOthers_Intercept + post$b_wOthers_SANSs)
aSelf <- c(post$b_aSelf_Intercept, post$b_aSelf_Intercept + post$b_aSelf_SANSs)
aOthers <- c(post$b_aOthers_Intercept, post$b_aOthers_Intercept + post$b_aOthers_SANSs)
SANS <- c(  rep(0,each=8000),  rep(1,each=8000)) 
xxx <- data.frame(SANS,wSelf,wOthers,aSelf,aOthers,bias,bConfidence)
Pars <- xxx %>% group_by(SANS) %>% dplyr::summarize(wSelf=mean(wSelf),wOthers=mean(wOthers),aSelf=mean(aSelf),aOthers=mean(aOthers),bias=mean(bias),bConfidence=mean(bConfidence))
Pars$wSelf_scale <- inv_logit_scaled(Pars$wSelf, 0.5, 1)
Pars$wOthers_scale <- inv_logit_scaled(Pars$wOthers + Pars$bConfidence, 0.5, 1)
Pars$wOthersLowConf_scale <- inv_logit_scaled(Pars$wOthers + (Pars$bConfidence*0.5), 0.5, 1)
Pars$aSelf_scale <- exp(Pars$aSelf)
Pars$aOthers_scale <- exp(Pars$aOthers)

loo_compare(circular_schizo_confidence_baseline_m, circular_saps_m, criterion="loo")
model_weights(circular_schizo_confidence_baseline_m, circular_saps_m, criterion="loo")
summary(circular_saps_m)
hypothesis(circular_saps_m,"wSelf_SAPSs > 0")
hypothesis(circular_saps_m,"wOthers_SAPSs < 0")
hypothesis(circular_saps_m,"aSelf_SAPSs > 0")
hypothesis(circular_saps_m,"aOthers_SAPSs < 0")
# Calculate estimates
post <- posterior_samples(circular_saps_m)
bias <- c(post$b_bias_Intercept, post$b_bias_Intercept)
bConfidence <- c(post$b_bConfidence_Intercept, post$b_bConfidence_Intercept + post$b_bConfidence_SAPSs)
wSelf <- c(post$b_wSelf_Intercept, post$b_wSelf_Intercept + post$b_wSelf_SAPSs)
wOthers <- c(post$b_wOthers_Intercept, post$b_wOthers_Intercept + post$b_wOthers_SAPSs)
aSelf <- c(post$b_aSelf_Intercept, post$b_aSelf_Intercept + post$b_aSelf_SAPSs)
aOthers <- c(post$b_aOthers_Intercept, post$b_aOthers_Intercept + post$b_aOthers_SAPSs)
SAPS <- c(  rep(0,each=8000),  rep(1,each=8000)) 
xxx <- data.frame(SAPS,wSelf,wOthers,aSelf,aOthers,bias,bConfidence)
Pars <- xxx %>% group_by(SAPS) %>% dplyr::summarize(wSelf=mean(wSelf),wOthers=mean(wOthers),aSelf=mean(aSelf),aOthers=mean(aOthers),bias=mean(bias),bConfidence=mean(bConfidence))
Pars$wSelf_scale <- inv_logit_scaled(Pars$wSelf, 0.5, 1)
Pars$wOthers_scale <- inv_logit_scaled(Pars$wOthers + Pars$bConfidence, 0.5, 1)
Pars$wOthersLowConf_scale <- inv_logit_scaled(Pars$wOthers + (Pars$bConfidence*0.5), 0.5, 1)
Pars$aSelf_scale <- exp(Pars$aSelf)
Pars$aOthers_scale <- exp(Pars$aOthers)

loo_compare(circular_schizo_confidence_baseline_m, circular_psp_m, criterion="loo")
model_weights(circular_schizo_confidence_baseline_m, circular_psp_m, criterion="loo")
summary(circular_psp_m)
hypothesis(circular_psp_m,"wSelf_PSPs_schizo < 0")
hypothesis(circular_psp_m,"wOthers_PSPs_schizo > 0")
hypothesis(circular_psp_m,"aSelf_PSPs_schizo < 0")
hypothesis(circular_psp_m,"aOthers_PSPs_schizo > 0")

post <- posterior_samples(circular_psp_m)
bias <- c(post$b_bias_Intercept, post$b_bias_Intercept)
bConfidence <- c(post$b_bConfidence_Intercept, post$b_bConfidence_Intercept + post$b_bConfidence_PSPs_schizo)
wSelf <- c(post$b_wSelf_Intercept, post$b_wSelf_Intercept + post$b_wSelf_PSPs_schizo)
wOthers <- c(post$b_wOthers_Intercept, post$b_wOthers_Intercept + post$b_wOthers_PSPs_schizo)
aSelf <- c(post$b_aSelf_Intercept, post$b_aSelf_Intercept + post$b_aSelf_PSPs_schizo)
aOthers <- c(post$b_aOthers_Intercept, post$b_aOthers_Intercept + post$b_aOthers_PSPs_schizo)
PSP <- c(  rep(0,each=8000),  rep(1,each=8000)) 
xxx <- data.frame(PSP,wSelf,wOthers,aSelf,aOthers,bias,bConfidence)
Pars <- xxx %>% group_by(PSP) %>% dplyr::summarize(wSelf=mean(wSelf),wOthers=mean(wOthers),aSelf=mean(aSelf),aOthers=mean(aOthers),bias=mean(bias),bConfidence=mean(bConfidence))
Pars$wSelf_scale <- inv_logit_scaled(Pars$wSelf, 0.5, 1)
Pars$wOthers_scale <- inv_logit_scaled(Pars$wOthers + Pars$bConfidence, 0.5, 1)
Pars$wOthersLowConf_scale <- inv_logit_scaled(Pars$wOthers + (Pars$bConfidence*0.5), 0.5, 1)
Pars$aSelf_scale <- exp(Pars$aSelf)
Pars$aOthers_scale <- exp(Pars$aOthers)
```

## Control analyses

### Control analysis 1: Testing whether the single groups have the same ranking

```{r}
### Schizophrenia
load("models/weighted_confidence_schizo_m")
load("models/glm_confidence_schizo_m")
load("models/circular_schizo_confidence_baseline_m")

loo_compare(circular_schizo_confidence_baseline_m,weighted_confidence_schizo_m,glm_confidence_schizo_m)
model_weights(circular_schizo_confidence_baseline_m,weighted_confidence_schizo_m,glm_confidence_schizo_m)

### Schizophrenia
load("models/weighted_confidence_ctrl_m")
load("models/glm_confidence_ctrl_m")
load("models/circular_ctrl_confidence_baseline_m")

loo_compare(circular_ctrl_confidence_baseline_m,weighted_confidence_ctrl_m,glm_confidence_ctrl_m)
model_weights(circular_ctrl_confidence_baseline_m,weighted_confidence_ctrl_m,glm_confidence_ctrl_m)
```


### Control analysis 2: Testing whether the interference term is making the model too complex

```{r}

circular_noI_diagnosis_f = bf(ChoiceRed ~ bias + 
                   F(aSelf, lSelf, wSelf) +
                   F(aOthers, lOthers1, wOthers + bConfidence * Confidence1) +
                   F(aOthers, lOthers2, wOthers + bConfidence * Confidence2) +
                   F(aOthers, lOthers3, wOthers + bConfidence * Confidence3) +
                   F(aOthers, lOthers4, wOthers + bConfidence * Confidence4),
               wSelf + wOthers + aSelf + aOthers + bConfidence + bias ~ 1 + Diagnosis + (1 + Diagnosis|p|SubjectPair) ,
               nl = TRUE)

circular_prior = c(prior(normal(0,.3), nlpar = "wSelf"),
                   prior(normal(0,.3), nlpar = "wOthers"),
                   prior(normal(0,.3), nlpar = "aSelf"),
                   prior(normal(0,.3), nlpar = "aOthers"),
                   prior(normal(1,.5), nlpar = "bConfidence"),
                   prior(normal(0,.1), nlpar = "bias"),
                   prior(normal(1,1), nlpar = "wSelf", coef = "Intercept"),
                   prior(normal(1,1), nlpar = "wOthers", coef = "Intercept"),
                   prior(normal(0,1), nlpar = "aSelf", coef = "Intercept"),
                   prior(normal(0,1), nlpar = "aOthers", coef = "Intercept"),
                   prior(normal(0, .2), nlpar = "wSelf",class="sd"),
                   prior(normal(0, .2), nlpar = "wOthers",class="sd"),
                   prior(normal(0, .2), nlpar = "aSelf",class="sd"),
                   prior(normal(0, .2), nlpar = "aOthers",class="sd"),
                   prior(normal(0, .2), nlpar = "bConfidence",class="sd"),
                   prior(normal(0, .2), nlpar = "bias",class="sd"),
                   prior_("lkj(8)", class = "cor"))

circular_noI_diagnosis_m = brm(circular_noI_diagnosis_f,
               full_data,
               stan_funs = F_stancode,
               prior = circular_prior,
               sample_prior = TRUE,
               family = "bernoulli",
               chains = N_CORES, cores = N_CORES, iter = ITER,
               control = STAN_CONTROL)

circular_noI_diagnosis_m <- add_criterion(circular_noI_diagnosis_m,criterion=c("waic","loo","R2"))
save(circular_noI_diagnosis_m, file = "models/Arndis/circular_noI_diagnosis_m")
```

## Figures for the article

### Figure 2: Circular inference estimates by diagnosis

```{r}
load("models/circular_diagnosis_m")
### First generate all posterior samples for loops and weights by matched pair: intercept and diagnosis effect.
post <- posterior_samples(circular_diagnosis_m)


bias <- c(post$b_bias_Intercept,
          post$b_bias_Intercept + post$b_bias_Diagnosis)

bConfidence <- c(post$b_bConfidence_Intercept,
                 post$b_bConfidence_Intercept + post$b_bConfidence_Diagnosis)

wSelf <- c(post$b_wSelf_Intercept, 
           post$b_wSelf_Intercept + post$b_wSelf_Diagnosis)

wOthers <- c(post$b_wOthers_Intercept, 
             post$b_wOthers_Intercept + post$b_wOthers_Diagnosis)

aSelf <- c(post$b_aSelf_Intercept,
           post$b_aSelf_Intercept + post$b_aSelf_Diagnosis)

aOthers <- c(post$b_aOthers_Intercept,
             post$b_aOthers_Intercept + post$b_aOthers_Diagnosis)


Diagnosis <- c(  rep(0,each=8000),  rep(1,each=8000)) 

xxx <- data.frame(Diagnosis=as.factor(Diagnosis),wSelf,wOthers,aSelf,aOthers,bias,bConfidence)

## Use the xxx dataset
Pars <- xxx %>% group_by(Diagnosis) %>% dplyr::summarize(wSelf=mean(wSelf),wOthers=mean(wOthers),aSelf=mean(aSelf),aOthers=mean(aOthers),bias=mean(bias),bConfidence=mean(bConfidence))
## Merge to fulldata
d <- full_data
d$SANS_i0=NULL
d$SANS_noAttention_i0=NULL
d$SAPS_i0=NULL
d$PSP_i0=NULL
d$SAPSalt_i0=NULL
d$SANSalt_i0=NULL

# Summarize performance by group
Raw <-d %>% 
  group_by(Diagnosis,lSelf,lOthers1noC,Confidence1,lOthers2noC,Confidence2,lOthers3noC,Confidence3,lOthers4noC,Confidence4) %>%
  summarize(Red=mean(RedChoice))


F2 <- function(a_raw, L_raw, w_raw) {
  # weighting function in R
  a = exp(a_raw)
  L = exp(L_raw * a)
  w = inv_logit_scaled(w_raw, 0.5, 1)
  log((w * L + 1 - w)/((1 - w) * L + w))
}

d0 <- unique(d[,c('lOthers1noC','Confidence1','lOthers2noC','Confidence2','lOthers3noC','Confidence3','lOthers4noC','Confidence4')])
d0 <- d0 %>% mutate (Others = lOthers1noC*Confidence1 + lOthers2noC*Confidence2 + lOthers3noC*Confidence3 + lOthers4noC*Confidence4)
d0 <- d0[order(d0$Others),]

SocInfoLvls <- c("4 green high confidence",
  "3 green high confidence, 1 red low confidence",
  "4 green low confidence",
  "3 green high confidence, 1 red high confidence",
  "3 green low confidence, 1 red low confidence",
  "3 green high confidence, 2 red low confidence",
  "3 green low confidence, 1 red high confidence",
  "2 green low confidence, 2 red low confidence",
  "2 green high confidence, 2 red high confidence",
  "1 green high confidence, 3 red low confidence",
  "2 green low confidence, 2 red high confidence",
  "1 green low confidence, 3 red low confidence",
  "4 red low confidence",
  "1 green high confidence, 3 red high confidence",
  "1 green low confidence, 3 red high confidence",
  "4 red high confidence")

d0$SocialInformation <- factor(SocInfoLvls,levels = SocInfoLvls)

d1 <- expand.grid(
  lSelf=seq(-1.9459101,1.9459101,0.001),
  Diagnosis=c(0,1))

d1 <- merge(d0,d1,all=T)

d1 <- merge(d1,Pars, by="Diagnosis")
d1 <- d1 %>% mutate(
  y = bias + F2(0, lSelf + F2(aSelf, lSelf, wSelf) +
                  F2(aOthers, lOthers1noC, wOthers + bConfidence * Confidence1) +
                  F2(aOthers, lOthers2noC, wOthers + bConfidence * Confidence2) +
                  F2(aOthers, lOthers3noC, wOthers + bConfidence * Confidence3) +
                  F2(aOthers, lOthers4noC, wOthers + bConfidence * Confidence4), wSelf) +
    F2(0, lOthers1noC + F2(aSelf, lSelf, wSelf) +
         F2(aOthers, lOthers1noC, wOthers + bConfidence * Confidence1) +
         F2(aOthers, lOthers2noC, wOthers + bConfidence * Confidence2) +
         F2(aOthers, lOthers3noC, wOthers + bConfidence * Confidence3) +
         F2(aOthers, lOthers4noC, wOthers + bConfidence * Confidence4), wOthers + bConfidence * Confidence1) +
    F2(0, lOthers2noC + F2(aSelf, lSelf, wSelf) +
         F2(aOthers, lOthers1noC, wOthers + bConfidence * Confidence1) +
         F2(aOthers, lOthers2noC, wOthers + bConfidence * Confidence2) +
         F2(aOthers, lOthers3noC, wOthers + bConfidence * Confidence3) +
         F2(aOthers, lOthers4noC, wOthers + bConfidence * Confidence4), wOthers + bConfidence * Confidence2) +
    F2(0, lOthers3noC + F2(aSelf, lSelf, wSelf) +
         F2(aOthers, lOthers1noC, wOthers + bConfidence * Confidence1) +
         F2(aOthers, lOthers2noC, wOthers + bConfidence * Confidence2) +
         F2(aOthers, lOthers3noC, wOthers + bConfidence * Confidence3) +
         F2(aOthers, lOthers4noC, wOthers + bConfidence * Confidence4), wOthers + bConfidence * Confidence3) +
    F2(0, lOthers4noC + F2(aSelf, lSelf, wSelf) +
         F2(aOthers, lOthers1noC, wOthers + bConfidence * Confidence1) +
         F2(aOthers, lOthers2noC, wOthers + bConfidence * Confidence2) +
         F2(aOthers, lOthers3noC, wOthers + bConfidence * Confidence3) +
         F2(aOthers, lOthers4noC, wOthers + bConfidence * Confidence4), wOthers + bConfidence * Confidence4),
  Others = lOthers1noC*Confidence1 + lOthers2noC*Confidence2 + lOthers3noC*Confidence3 + lOthers4noC*Confidence4
)

#d1 <- merge(d1,Raw,all=T)

d1$Diagnosis[d1$Diagnosis==0]="Control"
d1$Diagnosis[d1$Diagnosis==1]="Schizophrenia"

CI_bySelf <- ggplot(d1,aes(lSelf,inv.logit(y),color=SocialInformation,group=SocialInformation))+
  geom_line(size=1)+
#  geom_point(aes(lSelf,Red))+
  theme_classic()+
  facet_wrap(.~Diagnosis)+
  xlab("Reds in sample")+
  ylab("Propensity to choose red") +
  scale_x_continuous(breaks=sort(unique(d$lSelf)),labels=seq(1,7,1))+
  guides(color=FALSE,group=FALSE)

CI_bySelf

# Now the opposite plot
d0 <- data.frame(lSelf = sort(unique(d$lSelf)))

IndInfoLvls <- c(
  "7 red, 1 green", 
  "6 red, 2 green", 
  "5 red, 3 green",
  "4 red, 4 green", 
  "3 red, 5 green",
  "2 red, 6 green",
  "1 red, 7 green")

d0$IndividualInformation <- factor(IndInfoLvls,levels=IndInfoLvls)

d2 <- expand.grid(
  lOthers=seq(-8.788898,8.788898,0.01),
  Diagnosis=c(0,1))

d2 <- merge(d0,d2,all=T)

d2 <- merge(d2,Pars, by="Diagnosis")

d2 <- d2 %>% mutate(
  y = bias + 
    F2(0, lSelf + F2(aSelf, lSelf, wSelf) +
                  F2(aOthers, lOthers, wOthers+bConfidence), wSelf) +
    F2(0, lOthers + F2(aSelf, lSelf, wSelf) +
         F2(aOthers, lOthers, wOthers + bConfidence), wOthers + bConfidence))

d2$Diagnosis[d2$Diagnosis==0]="Control"
d2$Diagnosis[d2$Diagnosis==1]="Schizophrenia"

CI_byOthers <- ggplot(d2,aes(lOthers,inv.logit(y),color=IndividualInformation,group=IndividualInformation))+
  geom_line(size=1)+
  theme_classic()+
  facet_wrap(.~Diagnosis)+
  xlab("Evidence provided by Others")+
  ylab("Propensity to choose red")+
  guides(color=FALSE,group=FALSE)

CI_byOthers

ggarrange(CI_byOthers,CI_bySelf,nrow = 2)
```

## Figures for the supplementary materials

### Figure S1 - Illustrating effects of different weights on Weighted Bayes

```{r}

F1 <- function(a_raw, L_raw, w_raw) {
    # weighting function in R
    a = exp(a_raw)
    L = exp(L_raw * a)
    #w = inv_logit_scaled(w_raw, 0.5, 1)
    w = w_raw
    log((w * L + 1 - w)/((1 - w) * L + w))
}

simD <- expand.grid(x = seq(-3, 3, length.out = 100), 
            w = seq(0.5, 1, .1)) %>%
        mutate(out = F1(0,x, w),
               prob = inv.logit(out),
               evidence= inv.logit(x)) %>%
        mutate(w = as.factor(w))
  
  
weightPlot <- ggplot(simD,aes(x, prob, colour=w, group=w)) +
  geom_line() + 
  labs(y = "Probability of choosing red", x="Evidence for red") +
  theme_classic()

weightPlot

```

### Figure S2 - Illustrating effects of different loops on Circular Inference

```{r}

# 3 levels of loop: log(-1), log(0), log(1)

simD <- expand.grid(x = seq(-3, 3, length.out = 100), 
            w = seq(0.5, 1, .1)) %>%
        mutate(out = F1(-1,x, w),
               prob = inv.logit(out),
               evidence= inv.logit(x)) %>%
        mutate(w = as.factor(w))
  
  
LoopPlot0 <- ggplot(simD,aes(x, prob, colour=w, group=w)) +
  geom_line() + 
  labs(y = "Probability of choosing red", x="Self") +
  theme_classic()

simD <- expand.grid(x = seq(-3, 3, length.out = 100), 
            w = seq(0.5, 1, .1)) %>%
        mutate(out = F1(1,x, w),
               prob = inv.logit(out),
               evidence= inv.logit(x)) %>%
        mutate(w = as.factor(w))
  
  
LoopPlot2 <- ggplot(simD,aes(x, prob, colour=w, group=w)) +
  geom_line() + 
  labs(y = "Probability of choosing red", x="Self") +
  theme_classic()

simD <- expand.grid(x = seq(-3, 3, length.out = 100), 
            w = seq(0.5, 1, .1)) %>%
        mutate(out = F1(0,x, w),
               prob = inv.logit(out),
               evidence= inv.logit(x)) %>%
        mutate(w = as.factor(w))
  
  
LoopPlot1 <- ggplot(simD,aes(x, prob, colour=w, group=w)) +
  geom_line() + 
  labs(y = "Probability of choosing red", x="Self") +
  theme_classic()

simD <- expand.grid(x = seq(-3, 3, length.out = 100), 
            w = seq(0.5, 1, .1)) %>%
        mutate(out = F1(1,x, w),
               prob = inv.logit(out),
               evidence= inv.logit(x)) %>%
        mutate(w = as.factor(w))
  
  
LoopPlot2 <- ggplot(simD,aes(x, prob, colour=w, group=w)) +
  geom_line() + 
  labs(y = "Probability of choosing red", x="Self") +
  theme_classic()

ggarrange(LoopPlot0,LoopPlot1 ,LoopPlot2,ncol=3)
ggsave("LoopPlots.svg")
```

### Figure S3 - Forest plot of weight and loop parameters by participant in CI

```{r}
load("models/circular_diagnosis_m")
### First generate all posterior samples for loops and weights by matched pair: intercept and diagnosis effect.
post <- posterior_samples(circular_diagnosis_m)
### I want a dataset with
#### Subject
#### Diagnosis
#### w Self
#### w Others
#### a Self
#### a Others
### Then sum random to fixed effect and create both control and patient

### Then select only existing participants
### We have all controls
### We only have the following patients unique(full_data$SubjectPair[full_data$Group=="1"])

### Then scale to correct scale

### Then plot

bias <- c(exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[1,Intercept]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[2,Intercept]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[3,Intercept]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[4,Intercept]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[5,Intercept]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[6,Intercept]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[7,Intercept]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[8,Intercept]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[9,Intercept]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[10,Intercept]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[11,Intercept]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[12,Intercept]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[13,Intercept]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[14,Intercept]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[15,Intercept]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[16,Intercept]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[17,Intercept]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[18,Intercept]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[19,Intercept]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[20,Intercept]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[21,Intercept]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[22,Intercept]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[23,Intercept]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[24,Intercept]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[25,Intercept]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[26,Intercept]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[27,Intercept]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[28,Intercept]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[29,Intercept]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[30,Intercept]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[31,Intercept]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[32,Intercept]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[33,Intercept]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[34,Intercept]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[35,Intercept]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[36,Intercept]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[37,Intercept]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[38,Intercept]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[39,Intercept]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[40,Intercept]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[1,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[1,Diagnosis]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[2,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[2,Diagnosis]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[3,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[3,Diagnosis]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[4,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[4,Diagnosis]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[5,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[5,Diagnosis]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[6,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[6,Diagnosis]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[8,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[8,Diagnosis]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[9,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[9,Diagnosis]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[10,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[10,Diagnosis]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[13,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[13,Diagnosis]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[15,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[15,Diagnosis]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[16,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[16,Diagnosis]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[17,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[17,Diagnosis]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[18,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[18,Diagnosis]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[19,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[19,Diagnosis]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[20,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[20,Diagnosis]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[21,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[21,Diagnosis]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[22,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[22,Diagnosis]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[23,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[23,Diagnosis]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[24,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[24,Diagnosis]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[25,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[25,Diagnosis]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[26,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[26,Diagnosis]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[27,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[27,Diagnosis]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[28,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[28,Diagnosis]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[29,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[29,Diagnosis]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[30,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[30,Diagnosis]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[31,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[31,Diagnosis]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[32,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[32,Diagnosis]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[33,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[33,Diagnosis]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[34,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[34,Diagnosis]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[36,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[36,Diagnosis]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[37,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[37,Diagnosis]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[38,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[38,Diagnosis]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[39,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[39,Diagnosis]`),
           exp(post$b_bias_Intercept + post$`r_SubjectPair__bias[40,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[40,Diagnosis]`))

bConfidence <- c(exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[1,Intercept]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[2,Intercept]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[3,Intercept]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[4,Intercept]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[5,Intercept]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[6,Intercept]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[7,Intercept]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[8,Intercept]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[9,Intercept]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[10,Intercept]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[11,Intercept]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[12,Intercept]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[13,Intercept]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[14,Intercept]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[15,Intercept]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[16,Intercept]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[17,Intercept]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[18,Intercept]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[19,Intercept]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[20,Intercept]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[21,Intercept]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[22,Intercept]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[23,Intercept]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[24,Intercept]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[25,Intercept]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[26,Intercept]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[27,Intercept]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[28,Intercept]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[29,Intercept]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[30,Intercept]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[31,Intercept]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[32,Intercept]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[33,Intercept]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[34,Intercept]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[35,Intercept]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[36,Intercept]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[37,Intercept]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[38,Intercept]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[39,Intercept]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[40,Intercept]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[1,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[1,Diagnosis]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[2,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[2,Diagnosis]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[3,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[3,Diagnosis]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[4,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[4,Diagnosis]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[5,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[5,Diagnosis]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[6,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[6,Diagnosis]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[8,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[8,Diagnosis]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[9,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[9,Diagnosis]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[10,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[10,Diagnosis]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[13,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[13,Diagnosis]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[15,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[15,Diagnosis]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[16,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[16,Diagnosis]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[17,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[17,Diagnosis]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[18,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[18,Diagnosis]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[19,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[19,Diagnosis]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[20,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[20,Diagnosis]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[21,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[21,Diagnosis]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[22,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[22,Diagnosis]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[23,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[23,Diagnosis]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[24,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[24,Diagnosis]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[25,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[25,Diagnosis]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[26,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[26,Diagnosis]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[27,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[27,Diagnosis]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[28,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[28,Diagnosis]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[29,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[29,Diagnosis]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[30,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[30,Diagnosis]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[31,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[31,Diagnosis]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[32,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[32,Diagnosis]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[33,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[33,Diagnosis]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[34,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[34,Diagnosis]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[36,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[36,Diagnosis]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[37,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[37,Diagnosis]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[38,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[38,Diagnosis]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[39,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[39,Diagnosis]`),
           exp(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[40,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[40,Diagnosis]`))

wSelf <- c(inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[1,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[2,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[3,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[4,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[5,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[6,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[7,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[8,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[9,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[10,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[11,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[12,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[13,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[14,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[15,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[16,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[17,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[18,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[19,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[20,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[21,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[22,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[23,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[24,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[25,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[26,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[27,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[28,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[29,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[30,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[31,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[32,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[33,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[34,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[35,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[36,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[37,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[38,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[39,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[40,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[1,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[1,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[2,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[2,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[3,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[3,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[4,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[4,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[5,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[5,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[6,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[6,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[8,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[8,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[9,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[9,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[10,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[10,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[13,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[13,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[15,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[15,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[16,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[16,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[17,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[17,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[18,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[18,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[19,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[19,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[20,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[20,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[21,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[21,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[22,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[22,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[23,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[23,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[24,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[24,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[25,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[25,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[26,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[26,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[27,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[27,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[28,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[28,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[29,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[29,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[30,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[30,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[31,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[31,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[32,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[32,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[33,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[33,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[34,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[34,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[36,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[36,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[37,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[37,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[38,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[38,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[39,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[39,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[40,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[40,Diagnosis]`, 0.5, 1))

wOthers <- c(inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[1,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[2,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[3,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[4,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[5,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[6,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[7,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[8,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[9,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[10,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[11,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[12,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[13,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[14,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[15,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[16,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[17,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[18,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[19,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[20,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[21,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[22,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[23,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[24,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[25,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[26,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[27,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[28,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[29,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[30,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[31,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[32,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[33,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[34,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[35,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[36,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[37,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[38,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[39,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[40,Intercept]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[1,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[1,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[2,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[2,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[3,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[3,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[4,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[4,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[5,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[5,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[6,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[6,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[8,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[8,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[9,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[9,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[10,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[10,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[13,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[13,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[15,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[15,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[16,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[16,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[17,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[17,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[18,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[18,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[19,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[19,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[20,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[20,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[21,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[21,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[22,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[22,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[23,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[23,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[24,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[24,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[25,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[25,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[26,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[26,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[27,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[27,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[28,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[28,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[29,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[29,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[30,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[30,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[31,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[31,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[32,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[32,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[33,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[33,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[34,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[34,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[36,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[36,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[37,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[37,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[38,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[38,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[39,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[39,Diagnosis]`, 0.5, 1),
           inv_logit_scaled(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[40,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[40,Diagnosis]`, 0.5, 1))

aSelf <- c(exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[1,Intercept]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[2,Intercept]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[3,Intercept]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[4,Intercept]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[5,Intercept]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[6,Intercept]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[7,Intercept]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[8,Intercept]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[9,Intercept]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[10,Intercept]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[11,Intercept]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[12,Intercept]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[13,Intercept]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[14,Intercept]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[15,Intercept]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[16,Intercept]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[17,Intercept]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[18,Intercept]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[19,Intercept]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[20,Intercept]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[21,Intercept]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[22,Intercept]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[23,Intercept]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[24,Intercept]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[25,Intercept]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[26,Intercept]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[27,Intercept]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[28,Intercept]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[29,Intercept]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[30,Intercept]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[31,Intercept]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[32,Intercept]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[33,Intercept]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[34,Intercept]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[35,Intercept]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[36,Intercept]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[37,Intercept]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[38,Intercept]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[39,Intercept]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[40,Intercept]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[1,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[1,Diagnosis]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[2,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[2,Diagnosis]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[3,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[3,Diagnosis]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[4,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[4,Diagnosis]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[5,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[5,Diagnosis]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[6,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[6,Diagnosis]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[8,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[8,Diagnosis]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[9,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[9,Diagnosis]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[10,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[10,Diagnosis]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[13,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[13,Diagnosis]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[15,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[15,Diagnosis]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[16,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[16,Diagnosis]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[17,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[17,Diagnosis]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[18,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[18,Diagnosis]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[19,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[19,Diagnosis]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[20,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[20,Diagnosis]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[21,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[21,Diagnosis]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[22,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[22,Diagnosis]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[23,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[23,Diagnosis]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[24,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[24,Diagnosis]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[25,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[25,Diagnosis]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[26,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[26,Diagnosis]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[27,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[27,Diagnosis]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[28,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[28,Diagnosis]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[29,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[29,Diagnosis]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[30,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[30,Diagnosis]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[31,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[31,Diagnosis]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[32,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[32,Diagnosis]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[33,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[33,Diagnosis]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[34,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[34,Diagnosis]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[36,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[36,Diagnosis]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[37,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[37,Diagnosis]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[38,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[38,Diagnosis]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[39,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[39,Diagnosis]`),
           exp(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[40,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[40,Diagnosis]`))

aOthers <- c(exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[1,Intercept]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[2,Intercept]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[3,Intercept]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[4,Intercept]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[5,Intercept]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[6,Intercept]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[7,Intercept]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[8,Intercept]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[9,Intercept]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[10,Intercept]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[11,Intercept]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[12,Intercept]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[13,Intercept]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[14,Intercept]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[15,Intercept]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[16,Intercept]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[17,Intercept]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[18,Intercept]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[19,Intercept]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[20,Intercept]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[21,Intercept]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[22,Intercept]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[23,Intercept]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[24,Intercept]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[25,Intercept]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[26,Intercept]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[27,Intercept]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[28,Intercept]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[29,Intercept]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[30,Intercept]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[31,Intercept]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[32,Intercept]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[33,Intercept]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[34,Intercept]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[35,Intercept]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[36,Intercept]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[37,Intercept]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[38,Intercept]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[39,Intercept]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[40,Intercept]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[1,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[1,Diagnosis]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[2,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[2,Diagnosis]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[3,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[3,Diagnosis]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[4,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[4,Diagnosis]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[5,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[5,Diagnosis]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[6,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[6,Diagnosis]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[8,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[8,Diagnosis]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[9,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[9,Diagnosis]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[10,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[10,Diagnosis]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[13,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[13,Diagnosis]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[15,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[15,Diagnosis]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[16,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[16,Diagnosis]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[17,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[17,Diagnosis]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[18,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[18,Diagnosis]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[19,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[19,Diagnosis]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[20,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[20,Diagnosis]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[21,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[21,Diagnosis]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[22,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[22,Diagnosis]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[23,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[23,Diagnosis]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[24,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[24,Diagnosis]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[25,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[25,Diagnosis]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[26,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[26,Diagnosis]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[27,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[27,Diagnosis]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[28,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[28,Diagnosis]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[29,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[29,Diagnosis]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[30,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[30,Diagnosis]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[31,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[31,Diagnosis]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[32,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[32,Diagnosis]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[33,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[33,Diagnosis]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[34,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[34,Diagnosis]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[36,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[36,Diagnosis]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[37,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[37,Diagnosis]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[38,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[38,Diagnosis]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[39,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[39,Diagnosis]`),
           exp(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[40,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[40,Diagnosis]`))

Subject<-rep(c(unique(full_data$SubjectPair[full_data$Group=="0"]),unique(full_data$SubjectPair[full_data$Group=="1"])),each=8000)
Diagnosis <- c(  rep(0,each=8000*40),  rep(1,each=8000*length(unique(full_data$SubjectPair[full_data$Group=="1"])))) 

xxx <- data.frame(Subject,Diagnosis=as.factor(Diagnosis),wSelf,wOthers,aSelf,aOthers,bias,bConfidence)
xxx$ID=xxx$Subject
xxx$ID[xxx$Diagnosis==0]=xxx$ID[xxx$Diagnosis==0]+100
xxx$ID <- as.numeric(as.factor(xxx$ID))

ForestWself <- ggplot(xxx, aes(x = wSelf, y = ID, group=ID,fill=Diagnosis)) + geom_density_ridges(rel_min_height = 0.01)+theme_classic()
ggsave(ForestWself, file="ForestWself.svg", width=9,height=9)
ForestWothers <- ggplot(xxx, aes(x = wOthers, y = ID, group=ID,fill=Diagnosis)) + geom_density_ridges(rel_min_height = 0.01)+theme_classic()
ggsave(ForestWothers, file="ForestWothers.svg", width=9,height=9)
ForestAself <- ggplot(xxx, aes(x = aSelf, y = ID, group=ID,fill=Diagnosis)) + geom_density_ridges(rel_min_height = 0.01)+theme_classic()
ggsave(ForestAself, file="ForestAself.svg", width=9,height=9)
ForestAothers <- ggplot(xxx, aes(x = aOthers, y = ID, group=ID,fill=Diagnosis)) + geom_density_ridges(rel_min_height = 0.01)+theme_classic()
ggsave(ForestAothers, file="ForestAothers.svg", width=9,height=9)

ggpubr::ggarrange(ForestWself,ForestAself,ForestWothers,ForestAothers)
ggsave(file="ForestAll.svg", width=9,height=9)
```

### Figure S4 - CI plot by participant

```{r}
load("models/circular_diagnosis_m")
### First generate all posterior samples for loops and weights by matched pair: intercept and diagnosis effect.
post <- posterior_samples(circular_diagnosis_m)
### Then a dataset with
#### Subject
#### Diagnosis
#### w Self
#### w Others
#### a Self
#### a Others
### Then sum random to fixed effect and create both control and patient

### Then select only existing participants
### We have all controls
### We only have the following patients unique(full_data$SubjectPair[full_data$Group=="1"])

### Then scale to correct scale

### Then plot

bias <- c(post$b_bias_Intercept + post$`r_SubjectPair__bias[1,Intercept]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[2,Intercept]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[3,Intercept]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[4,Intercept]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[5,Intercept]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[6,Intercept]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[7,Intercept]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[8,Intercept]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[9,Intercept]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[10,Intercept]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[11,Intercept]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[12,Intercept]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[13,Intercept]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[14,Intercept]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[15,Intercept]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[16,Intercept]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[17,Intercept]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[18,Intercept]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[19,Intercept]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[20,Intercept]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[21,Intercept]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[22,Intercept]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[23,Intercept]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[24,Intercept]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[25,Intercept]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[26,Intercept]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[27,Intercept]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[28,Intercept]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[29,Intercept]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[30,Intercept]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[31,Intercept]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[32,Intercept]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[33,Intercept]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[34,Intercept]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[35,Intercept]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[36,Intercept]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[37,Intercept]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[38,Intercept]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[39,Intercept]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[40,Intercept]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[1,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[1,Diagnosis]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[2,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[2,Diagnosis]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[3,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[3,Diagnosis]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[4,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[4,Diagnosis]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[5,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[5,Diagnosis]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[6,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[6,Diagnosis]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[8,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[8,Diagnosis]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[9,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[9,Diagnosis]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[10,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[10,Diagnosis]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[13,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[13,Diagnosis]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[15,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[15,Diagnosis]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[16,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[16,Diagnosis]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[17,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[17,Diagnosis]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[18,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[18,Diagnosis]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[19,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[19,Diagnosis]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[20,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[20,Diagnosis]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[21,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[21,Diagnosis]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[22,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[22,Diagnosis]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[23,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[23,Diagnosis]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[24,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[24,Diagnosis]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[25,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[25,Diagnosis]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[26,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[26,Diagnosis]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[27,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[27,Diagnosis]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[28,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[28,Diagnosis]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[29,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[29,Diagnosis]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[30,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[30,Diagnosis]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[31,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[31,Diagnosis]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[32,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[32,Diagnosis]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[33,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[33,Diagnosis]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[34,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[34,Diagnosis]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[36,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[36,Diagnosis]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[37,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[37,Diagnosis]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[38,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[38,Diagnosis]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[39,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[39,Diagnosis]`,
          post$b_bias_Intercept + post$`r_SubjectPair__bias[40,Intercept]` + post$b_bias_Diagnosis + post$`r_SubjectPair__bias[40,Diagnosis]`)

bConfidence <- c(post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[1,Intercept]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[2,Intercept]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[3,Intercept]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[4,Intercept]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[5,Intercept]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[6,Intercept]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[7,Intercept]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[8,Intercept]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[9,Intercept]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[10,Intercept]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[11,Intercept]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[12,Intercept]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[13,Intercept]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[14,Intercept]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[15,Intercept]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[16,Intercept]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[17,Intercept]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[18,Intercept]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[19,Intercept]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[20,Intercept]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[21,Intercept]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[22,Intercept]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[23,Intercept]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[24,Intercept]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[25,Intercept]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[26,Intercept]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[27,Intercept]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[28,Intercept]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[29,Intercept]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[30,Intercept]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[31,Intercept]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[32,Intercept]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[33,Intercept]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[34,Intercept]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[35,Intercept]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[36,Intercept]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[37,Intercept]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[38,Intercept]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[39,Intercept]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[40,Intercept]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[1,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[1,Diagnosis]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[2,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[2,Diagnosis]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[3,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[3,Diagnosis]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[4,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[4,Diagnosis]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[5,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[5,Diagnosis]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[6,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[6,Diagnosis]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[8,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[8,Diagnosis]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[9,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[9,Diagnosis]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[10,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[10,Diagnosis]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[13,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[13,Diagnosis]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[15,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[15,Diagnosis]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[16,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[16,Diagnosis]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[17,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[17,Diagnosis]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[18,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[18,Diagnosis]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[19,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[19,Diagnosis]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[20,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[20,Diagnosis]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[21,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[21,Diagnosis]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[22,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[22,Diagnosis]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[23,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[23,Diagnosis]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[24,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[24,Diagnosis]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[25,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[25,Diagnosis]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[26,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[26,Diagnosis]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[27,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[27,Diagnosis]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[28,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[28,Diagnosis]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[29,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[29,Diagnosis]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[30,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[30,Diagnosis]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[31,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[31,Diagnosis]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[32,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[32,Diagnosis]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[33,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[33,Diagnosis]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[34,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[34,Diagnosis]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[36,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[36,Diagnosis]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[37,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[37,Diagnosis]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[38,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[38,Diagnosis]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[39,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[39,Diagnosis]`,
                 post$b_bConfidence_Intercept + post$`r_SubjectPair__bConfidence[40,Intercept]` + post$b_bConfidence_Diagnosis + post$`r_SubjectPair__bConfidence[40,Diagnosis]`)

wSelf <- c(post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[1,Intercept]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[2,Intercept]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[3,Intercept]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[4,Intercept]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[5,Intercept]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[6,Intercept]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[7,Intercept]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[8,Intercept]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[9,Intercept]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[10,Intercept]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[11,Intercept]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[12,Intercept]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[13,Intercept]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[14,Intercept]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[15,Intercept]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[16,Intercept]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[17,Intercept]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[18,Intercept]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[19,Intercept]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[20,Intercept]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[21,Intercept]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[22,Intercept]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[23,Intercept]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[24,Intercept]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[25,Intercept]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[26,Intercept]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[27,Intercept]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[28,Intercept]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[29,Intercept]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[30,Intercept]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[31,Intercept]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[32,Intercept]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[33,Intercept]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[34,Intercept]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[35,Intercept]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[36,Intercept]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[37,Intercept]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[38,Intercept]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[39,Intercept]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[40,Intercept]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[1,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[1,Diagnosis]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[2,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[2,Diagnosis]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[3,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[3,Diagnosis]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[4,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[4,Diagnosis]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[5,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[5,Diagnosis]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[6,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[6,Diagnosis]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[8,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[8,Diagnosis]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[9,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[9,Diagnosis]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[10,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[10,Diagnosis]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[13,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[13,Diagnosis]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[15,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[15,Diagnosis]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[16,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[16,Diagnosis]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[17,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[17,Diagnosis]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[18,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[18,Diagnosis]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[19,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[19,Diagnosis]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[20,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[20,Diagnosis]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[21,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[21,Diagnosis]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[22,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[22,Diagnosis]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[23,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[23,Diagnosis]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[24,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[24,Diagnosis]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[25,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[25,Diagnosis]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[26,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[26,Diagnosis]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[27,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[27,Diagnosis]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[28,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[28,Diagnosis]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[29,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[29,Diagnosis]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[30,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[30,Diagnosis]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[31,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[31,Diagnosis]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[32,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[32,Diagnosis]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[33,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[33,Diagnosis]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[34,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[34,Diagnosis]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[36,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[36,Diagnosis]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[37,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[37,Diagnosis]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[38,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[38,Diagnosis]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[39,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[39,Diagnosis]`, 
           post$b_wSelf_Intercept + post$`r_SubjectPair__wSelf[40,Intercept]` + post$b_wSelf_Diagnosis + post$`r_SubjectPair__wSelf[40,Diagnosis]`)

wOthers <- c(post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[1,Intercept]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[2,Intercept]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[3,Intercept]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[4,Intercept]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[5,Intercept]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[6,Intercept]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[7,Intercept]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[8,Intercept]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[9,Intercept]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[10,Intercept]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[11,Intercept]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[12,Intercept]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[13,Intercept]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[14,Intercept]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[15,Intercept]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[16,Intercept]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[17,Intercept]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[18,Intercept]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[19,Intercept]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[20,Intercept]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[21,Intercept]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[22,Intercept]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[23,Intercept]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[24,Intercept]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[25,Intercept]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[26,Intercept]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[27,Intercept]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[28,Intercept]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[29,Intercept]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[30,Intercept]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[31,Intercept]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[32,Intercept]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[33,Intercept]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[34,Intercept]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[35,Intercept]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[36,Intercept]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[37,Intercept]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[38,Intercept]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[39,Intercept]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[40,Intercept]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[1,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[1,Diagnosis]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[2,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[2,Diagnosis]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[3,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[3,Diagnosis]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[4,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[4,Diagnosis]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[5,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[5,Diagnosis]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[6,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[6,Diagnosis]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[8,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[8,Diagnosis]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[9,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[9,Diagnosis]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[10,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[10,Diagnosis]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[13,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[13,Diagnosis]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[15,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[15,Diagnosis]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[16,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[16,Diagnosis]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[17,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[17,Diagnosis]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[18,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[18,Diagnosis]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[19,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[19,Diagnosis]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[20,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[20,Diagnosis]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[21,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[21,Diagnosis]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[22,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[22,Diagnosis]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[23,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[23,Diagnosis]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[24,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[24,Diagnosis]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[25,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[25,Diagnosis]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[26,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[26,Diagnosis]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[27,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[27,Diagnosis]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[28,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[28,Diagnosis]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[29,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[29,Diagnosis]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[30,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[30,Diagnosis]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[31,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[31,Diagnosis]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[32,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[32,Diagnosis]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[33,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[33,Diagnosis]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[34,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[34,Diagnosis]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[36,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[36,Diagnosis]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[37,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[37,Diagnosis]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[38,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[38,Diagnosis]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[39,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[39,Diagnosis]`, 
             post$b_wOthers_Intercept + post$`r_SubjectPair__wOthers[40,Intercept]` + post$b_wOthers_Diagnosis + post$`r_SubjectPair__wOthers[40,Diagnosis]`)

aSelf <- c(post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[1,Intercept]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[2,Intercept]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[3,Intercept]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[4,Intercept]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[5,Intercept]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[6,Intercept]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[7,Intercept]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[8,Intercept]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[9,Intercept]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[10,Intercept]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[11,Intercept]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[12,Intercept]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[13,Intercept]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[14,Intercept]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[15,Intercept]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[16,Intercept]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[17,Intercept]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[18,Intercept]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[19,Intercept]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[20,Intercept]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[21,Intercept]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[22,Intercept]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[23,Intercept]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[24,Intercept]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[25,Intercept]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[26,Intercept]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[27,Intercept]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[28,Intercept]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[29,Intercept]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[30,Intercept]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[31,Intercept]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[32,Intercept]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[33,Intercept]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[34,Intercept]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[35,Intercept]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[36,Intercept]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[37,Intercept]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[38,Intercept]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[39,Intercept]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[40,Intercept]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[1,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[1,Diagnosis]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[2,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[2,Diagnosis]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[3,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[3,Diagnosis]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[4,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[4,Diagnosis]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[5,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[5,Diagnosis]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[6,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[6,Diagnosis]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[8,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[8,Diagnosis]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[9,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[9,Diagnosis]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[10,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[10,Diagnosis]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[13,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[13,Diagnosis]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[15,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[15,Diagnosis]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[16,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[16,Diagnosis]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[17,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[17,Diagnosis]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[18,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[18,Diagnosis]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[19,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[19,Diagnosis]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[20,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[20,Diagnosis]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[21,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[21,Diagnosis]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[22,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[22,Diagnosis]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[23,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[23,Diagnosis]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[24,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[24,Diagnosis]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[25,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[25,Diagnosis]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[26,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[26,Diagnosis]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[27,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[27,Diagnosis]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[28,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[28,Diagnosis]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[29,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[29,Diagnosis]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[30,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[30,Diagnosis]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[31,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[31,Diagnosis]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[32,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[32,Diagnosis]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[33,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[33,Diagnosis]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[34,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[34,Diagnosis]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[36,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[36,Diagnosis]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[37,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[37,Diagnosis]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[38,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[38,Diagnosis]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[39,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[39,Diagnosis]`,
           post$b_aSelf_Intercept + post$`r_SubjectPair__aSelf[40,Intercept]` + post$b_aSelf_Diagnosis + post$`r_SubjectPair__aSelf[40,Diagnosis]`)

aOthers <- c(post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[1,Intercept]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[2,Intercept]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[3,Intercept]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[4,Intercept]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[5,Intercept]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[6,Intercept]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[7,Intercept]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[8,Intercept]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[9,Intercept]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[10,Intercept]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[11,Intercept]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[12,Intercept]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[13,Intercept]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[14,Intercept]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[15,Intercept]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[16,Intercept]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[17,Intercept]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[18,Intercept]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[19,Intercept]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[20,Intercept]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[21,Intercept]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[22,Intercept]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[23,Intercept]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[24,Intercept]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[25,Intercept]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[26,Intercept]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[27,Intercept]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[28,Intercept]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[29,Intercept]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[30,Intercept]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[31,Intercept]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[32,Intercept]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[33,Intercept]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[34,Intercept]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[35,Intercept]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[36,Intercept]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[37,Intercept]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[38,Intercept]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[39,Intercept]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[40,Intercept]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[1,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[1,Diagnosis]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[2,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[2,Diagnosis]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[3,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[3,Diagnosis]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[4,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[4,Diagnosis]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[5,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[5,Diagnosis]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[6,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[6,Diagnosis]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[8,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[8,Diagnosis]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[9,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[9,Diagnosis]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[10,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[10,Diagnosis]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[13,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[13,Diagnosis]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[15,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[15,Diagnosis]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[16,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[16,Diagnosis]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[17,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[17,Diagnosis]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[18,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[18,Diagnosis]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[19,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[19,Diagnosis]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[20,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[20,Diagnosis]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[21,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[21,Diagnosis]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[22,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[22,Diagnosis]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[23,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[23,Diagnosis]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[24,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[24,Diagnosis]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[25,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[25,Diagnosis]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[26,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[26,Diagnosis]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[27,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[27,Diagnosis]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[28,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[28,Diagnosis]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[29,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[29,Diagnosis]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[30,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[30,Diagnosis]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[31,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[31,Diagnosis]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[32,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[32,Diagnosis]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[33,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[33,Diagnosis]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[34,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[34,Diagnosis]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[36,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[36,Diagnosis]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[37,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[37,Diagnosis]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[38,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[38,Diagnosis]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[39,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[39,Diagnosis]`,
             post$b_aOthers_Intercept + post$`r_SubjectPair__aOthers[40,Intercept]` + post$b_aOthers_Diagnosis + post$`r_SubjectPair__aOthers[40,Diagnosis]`)

Subject<-rep(c(unique(full_data$SubjectPair[full_data$Group=="0"]),unique(full_data$SubjectPair[full_data$Group=="1"])),each=8000)
Diagnosis <- c(  rep(0,each=8000*40),  rep(1,each=8000*length(unique(full_data$SubjectPair[full_data$Group=="1"])))) 

xxx <- data.frame(Subject,Diagnosis=as.factor(Diagnosis),wSelf,wOthers,aSelf,aOthers,bias,bConfidence)
xxx$ID=xxx$Subject
xxx$ID[xxx$Diagnosis==0]=xxx$ID[xxx$Diagnosis==0]+100
xxx$ID <- as.numeric(as.factor(xxx$ID))

## Use the xxx dataset
Pars <- xxx %>% group_by(Subject,ID,Diagnosis) %>% dplyr::summarize(wSelf=mean(wSelf),wOthers=mean(wOthers),aSelf=mean(aSelf),aOthers=mean(aOthers),bias=mean(bias),bConfidence=mean(bConfidence))
## Merge to fulldata
d <- merge(full_data,Pars, by.x=c("SubjectPair","Diagnosis"),by.y=c("Subject","Diagnosis"))
d$SANS_i0=NULL
d$SANS_noAttention_i0=NULL
d$SAPS_i0=NULL
d$PSP_i0=NULL
d$SAPSalt_i0=NULL
d$SANSalt_i0=NULL

F2 <- function(a_raw, L_raw, w_raw) {
  # weighting function in R
  a = exp(a_raw)
  L = exp(L_raw * a)
  w = inv_logit_scaled(w_raw, 0.5, 1)
  log((w * L + 1 - w)/((1 - w) * L + w))
}

d <- d %>% mutate(
  y = bias + F2(0, lSelf + F2(aSelf, lSelf, wSelf) +
                  F2(aOthers, lOthers1noC, wOthers + bConfidence * Confidence1) +
                  F2(aOthers, lOthers2noC, wOthers + bConfidence * Confidence2) +
                  F2(aOthers, lOthers3noC, wOthers + bConfidence * Confidence3) +
                  F2(aOthers, lOthers4noC, wOthers + bConfidence * Confidence4), wSelf) +
    F2(0, lOthers1noC + F2(aSelf, lSelf, wSelf) +
         F2(aOthers, lOthers1noC, wOthers + bConfidence * Confidence1) +
         F2(aOthers, lOthers2noC, wOthers + bConfidence * Confidence2) +
         F2(aOthers, lOthers3noC, wOthers + bConfidence * Confidence3) +
         F2(aOthers, lOthers4noC, wOthers + bConfidence * Confidence4), wOthers + bConfidence * Confidence1) +
    F2(0, lOthers2noC + F2(aSelf, lSelf, wSelf) +
         F2(aOthers, lOthers1noC, wOthers + bConfidence * Confidence1) +
         F2(aOthers, lOthers2noC, wOthers + bConfidence * Confidence2) +
         F2(aOthers, lOthers3noC, wOthers + bConfidence * Confidence3) +
         F2(aOthers, lOthers4noC, wOthers + bConfidence * Confidence4), wOthers + bConfidence * Confidence2) +
    F2(0, lOthers3noC + F2(aSelf, lSelf, wSelf) +
         F2(aOthers, lOthers1noC, wOthers + bConfidence * Confidence1) +
         F2(aOthers, lOthers2noC, wOthers + bConfidence * Confidence2) +
         F2(aOthers, lOthers3noC, wOthers + bConfidence * Confidence3) +
         F2(aOthers, lOthers4noC, wOthers + bConfidence * Confidence4), wOthers + bConfidence * Confidence3) +
    F2(0, lOthers4noC + F2(aSelf, lSelf, wSelf) +
         F2(aOthers, lOthers1noC, wOthers + bConfidence * Confidence1) +
         F2(aOthers, lOthers2noC, wOthers + bConfidence * Confidence2) +
         F2(aOthers, lOthers3noC, wOthers + bConfidence * Confidence3) +
         F2(aOthers, lOthers4noC, wOthers + bConfidence * Confidence4), wOthers + bConfidence * Confidence4),
  Others = lOthers1noC*Confidence1 + lOthers2noC*Confidence2 + lOthers3noC*Confidence3 + lOthers4noC*Confidence4
)

## Following ID
d$ID <- as.numeric(as.factor(d$Subject))
## Rename Others
d$SocialInformation <- as.factor(round(d$Others,2))
levels(d$SocialInformation) <- list(
  "4 red high confidence" = "8.79", 
  "3 red high confidence, 1 green low confidence" = "5.49", 
  "3 red high confidence, 1 green high confidence" = "4.39",
  "3 red low confidence, 1 green low confidence /n 2 red high confidence, 2 green low confidence"="2.2", 
  "3 red low confidence, 1 green high confidence"="1.1", 
  "2 red, 2 green, same confidence"="0", 
  "3 green low confidence, 1 red high confidence"="-1.1",
  "3 green low confidence, 1 red low confidence /n 2 green high confidence, 2 red low confidence"="-2.2", 
  "3 green high confidence, 1 red high confidence"="-4.39", 
  "3 green high confidence, 1 red low confidence"="-5.49",
  "4 green high confidence"="-8.79")

## Individual information
d$IndividualInformation <- as.factor(round(d$Self,2))
levels(d$IndividualInformation) <- list(
  "7 red, 1 green" = "0.88", 
  "6 red, 2 green" = "0.75", 
  "5 red, 3 green" = "0.62",
  "4 red, 4 green"="0.5", 
  "3 red, 5 green"="0.38",
  "2 red, 6 green" = "0.25",
  "1 red, 7 green"="0.12")


## Plot schizophrenia
d1<-subset(d,Diagnosis==1 & Subject!=134)
CI_byS_SO_schizo <- ggplot(d1,aes(Self,inv.logit(y),color=SocialInformation,group=SocialInformation))+
  geom_smooth(se=FALSE)+
  geom_point()+
  theme_classic()+
  facet_wrap(ID~.,ncol=4)+
  xlab("Reds in sample")+
  ylab("Propensity to choose red")

CI_byS_SO_schizo

d1<-subset(d,Diagnosis==0)
CI_byS_SO_ctrl <- ggplot(d1,aes(Self,inv.logit(y),color=SocialInformation,group=SocialInformation))+
  geom_smooth(se=FALSE)+
  geom_point()+
  theme_classic()+
  facet_wrap(ID~.,ncol=4)+
  xlab("Reds in sample")+
  ylab("Propensity to choose red")

CI_byS_SO_ctrl

ggpubr::ggarrange(CI_byS_SO_schizo,CI_byS_SO_ctrl,common.legend = TRUE, legend='right')
ggsave(file="CI_byS_SO.svg", width=19,height=15)

## Inverse plots
d1<-subset(d,Diagnosis==1 & Subject!=134)
CI_byS_OS_schizo <- ggplot(d1,aes(inv.logit(Others)*4,inv.logit(y),color=IndividualInformation,group=IndividualInformation))+
  geom_smooth(se=FALSE)+
  geom_point()+
  theme_classic()+
  facet_wrap(ID~.,ncol=4)+
  xlab("Others choosing red")+
  ylab("Propensity to choose red")

CI_byS_OS_schizo

d1<-subset(d,Diagnosis==0)
CI_byS_OS_ctrl <- ggplot(d1,aes(inv.logit(Others)*4,inv.logit(y),color=IndividualInformation,group=IndividualInformation))+
  geom_smooth(se=FALSE)+
  geom_point()+
  theme_classic()+
  facet_wrap(ID~.,ncol=4)+
  xlab("Others choosing red")+
  ylab("Propensity to choose red")

CI_byS_OS_ctrl

ggpubr::ggarrange(CI_byS_OS_schizo,CI_byS_OS_ctrl,common.legend = TRUE, legend='right')
ggsave(file="CI_byS_OS.svg", width=15,height=15)


```


